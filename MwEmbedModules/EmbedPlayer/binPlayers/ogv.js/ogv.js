!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ogvjs=t():e.ogvjs=t()}(window,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=37)}([function(e,t){!function(){"use strict";function t(e,t){throw new Error("abstract")}t.prototype.drawFrame=function(e){throw new Error("abstract")},t.prototype.clear=function(){throw new Error("abstract")},e.exports=t}()},function(e,t,r){var n="1.5.8-20180809032045-40c82e69";!function(){var t=this,i=r(34),o={OGVDemuxerOgg:"ogv-demuxer-ogg.js",OGVDemuxerOggW:"ogv-demuxer-ogg-wasm.js",OGVDemuxerWebM:"ogv-demuxer-webm.js",OGVDemuxerWebMW:"ogv-demuxer-webm-wasm.js",OGVDecoderAudioOpus:"ogv-decoder-audio-opus.js",OGVDecoderAudioOpusW:"ogv-decoder-audio-opus-wasm.js",OGVDecoderAudioVorbis:"ogv-decoder-audio-vorbis.js",OGVDecoderAudioVorbisW:"ogv-decoder-audio-vorbis-wasm.js",OGVDecoderVideoTheora:"ogv-decoder-video-theora.js",OGVDecoderVideoTheoraW:"ogv-decoder-video-theora-wasm.js",OGVDecoderVideoVP8:"ogv-decoder-video-vp8.js",OGVDecoderVideoVP8W:"ogv-decoder-video-vp8-wasm.js",OGVDecoderVideoVP8MT:"ogv-decoder-video-vp8-mt.js",OGVDecoderVideoVP9:"ogv-decoder-video-vp9.js",OGVDecoderVideoVP9W:"ogv-decoder-video-vp9-wasm.js",OGVDecoderVideoVP9MT:"ogv-decoder-video-vp9-mt.js"},a={OGVDecoderAudioOpus:"audio",OGVDecoderAudioOpusW:"audio",OGVDecoderAudioVorbis:"audio",OGVDecoderAudioVorbisW:"audio",OGVDecoderVideoTheora:"video",OGVDecoderVideoTheoraW:"video",OGVDecoderVideoVP8:"video",OGVDecoderVideoVP8W:"video",OGVDecoderVideoVP9:"video",OGVDecoderVideoVP9W:"video"},s={audio:{proxy:r(11),worker:"ogv-worker-audio.js"},video:{proxy:r(9),worker:"ogv-worker-video.js"}};function u(e){if(e){var t=d.base;return void 0===t?t="":t+="/",t+e+"?version="+encodeURIComponent(n)}throw new Error("asked for URL for unknown script "+e)}var f={},c={};var d={base:function(){if("object"!=typeof t.window);else for(var e,r,n=document.querySelectorAll("script"),i=/^(?:|(.*)\/)ogv(?:-support)?\.js(?:\?|#|$)/,o=0;o<n.length;o++)if((e=n[o].getAttribute("src"))&&(r=e.match(i)))return r[1]}(),wasmSupported:function(){return i.wasmSupported()},loadClass:function(e,r,n){if((n=n||{}).worker)this.workerProxy(e,r);else{var i=function(e){var t=o[e];if(t)return u(t);throw new Error("asked for URL for unknown class "+e)}(e);"function"==typeof t[e]?r(a):"object"==typeof t.window?function(e,t){if("done"==f[e])t();else if("loading"==f[e])c[e].push(t);else{f[e]="loading",c[e]=[t];var r=document.createElement("script");function n(t){var r=c[e];delete c[e],f[e]="done",r.forEach(function(e){e()})}r.addEventListener("load",n),r.addEventListener("error",n),r.src=e,document.querySelector("head").appendChild(r)}}(i,function(){r(a)}):"function"==typeof t.importScripts&&(t.importScripts(i),r(a))}function a(r){return(r=r||{}).locateFile=function(e){return"data:"===e.slice(0,5)?e:u(e)},r.pthreadMainPrefixURL=d.base+"/",r.mainScriptUrlOrBlob=o[e],t[e](r)}},workerProxy:function(e,t){var r=s[a[e]];if(!r)throw new Error("Requested worker for class with no proxy: "+e);var n,i=r.proxy,f=r.worker,c=u(o[e]),d=u(f),l=function(t){return new i(n,e,t)};if(d.match(/^https?:|\/\//i)){var h,p,m,v,y,b=!1,g=!1;function w(){if(1==b&&1==g){try{y=new Blob([m+" "+v],{type:"application/javascript"})}catch(e){window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder,(y=new BlobBuilder).append(m+" "+v),y=y.getBlob()}n=new Worker(URL.createObjectURL(y)),t(function(e){return Promise.resolve(new l(e))})}}(h=new XMLHttpRequest).open("GET",c,!0),h.onreadystatechange=function(){4==h.readyState&&200==h.status&&(m=h.responseText,b=!0,w())},h.send(),(p=new XMLHttpRequest).open("GET",d,!0),p.onreadystatechange=function(){4==p.readyState&&200==p.status&&(v=p.responseText,g=!0,w())},p.send()}else n=new Worker(d),t(function(e){return Promise.resolve(new l(e))})}};e.exports=d}()},function(e,t){e.exports=function(e){return Object.defineProperty(this,"length",{get:function(){return e.length}}),this.start=function(t){return e[t][0]},this.end=function(t){return e[t][1]},this}},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=r(5);function o(e){if(206==e.status)return function(e){var t=a(e);return t?parseInt(t[3],10):-1}(e);var t=e.getResponseHeader("Content-Length");return null===t||""===t?-1:parseInt(t,10)}function a(e){var t=e.getResponseHeader("Content-Range");return t&&t.match(/^bytes (\d+)-(\d+)\/(\d+)/)}var s=function(e){function t(e){var r=e.url,n=e.offset,i=e.length,o=e.cachever,a=void 0===o?0:o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return s.url=r,s.offset=n,s.length=i,s.cachever=a,s.loaded=!1,s.seekable=!1,s.headers={},s.eof=!1,s.bytesRead=0,s.xhr=new XMLHttpRequest,s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i),n(t,[{key:"load",value:function(){var e=this;return new Promise(function(t,r){var n=null;e._onAbort=function(e){n(),r(e)};var i=function(){if(2==e.xhr.readyState){if(206==e.xhr.status){var i=(s=e.xhr,(u=a(s))?parseInt(u[1],10):0);if(e.offset!=i)return console.log("Expected start at "+e.offset+" but got "+i+"; working around Safari range caching bug: https://bugs.webkit.org/show_bug.cgi?id=82672"),e.cachever++,e.emit("cachever"),e.abort(),n(),void e.load().then(t).catch(r);e.seekable=!0}e.xhr.status>=200&&e.xhr.status<300?(e.length=o(e.xhr),e.headers=function(e){var t={};return e.getAllResponseHeaders().split(/\r?\n/).forEach(function(e){var r=e.split(/:\s*/,2);r.length>1&&(t[r[0].toLowerCase()]=r[1])}),t}(e.xhr),e.onXHRStart()):(n(),r(new Error("HTTP error "+e.xhr.status)))}var s,u},s=function(){n(),r(new Error("network error"))},u=function(){n(),t()};n=function(){e.xhr.removeEventListener("readystatechange",i),e.xhr.removeEventListener("error",s),e.off("open",u),e._onAbort=null},e.initXHR(),e.xhr.addEventListener("readystatechange",i),e.xhr.addEventListener("error",s),e.on("open",u),e.xhr.send()})}},{key:"bufferToOffset",value:function(e){return Promise.reject(new Error("abstract"))}},{key:"abort",value:function(){if(this.xhr.abort(),this._onAbort){var e=this._onAbort;this._onAbort=null;var t=new Error("Aborted");t.name="AbortError",e(t)}}},{key:"initXHR",value:function(){var e=this.url;this.cachever&&(e+="?buggy_cachever="+this.cachever),this.xhr.open("GET",e);var t=null;(this.offset||this.length)&&(t="bytes="+this.offset+"-"),this.length&&(t+=this.offset+this.length-1),null!==t&&this.xhr.setRequestHeader("Range",t)}},{key:"onXHRStart",value:function(){throw new Error("abstract")}}]),t}();e.exports=s},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=r(3),o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i),n(t,[{key:"bufferToOffset",value:function(e){var t=this;return new Promise(function(r,n){t.eof||t.offset>=e?r():function(){var i=null;t._onAbort=function(e){i(),n(e)};var o=function(){t.offset>=e&&!t.eof&&(i(),r())},a=function(){i(),r()},s=function(){i(),n(new Error("error streaming"))};i=function(){t.buffering=!1,t.off("buffer",o),t.off("done",a),t.off("error",s),t._onAbort=null},t.buffering=!0,t.on("buffer",o),t.on("done",a),t.on("error",s)}()})}},{key:"initXHR",value:function(){(function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(n):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initXHR",this).call(this)}},{key:"onXHRStart",value:function(){var e=this;this.xhr.addEventListener("progress",function(){return e.onXHRProgress()}),this.xhr.addEventListener("error",function(){return e.onXHRError()}),this.xhr.addEventListener("load",function(){return e.onXHRLoad()}),this.emit("open")}},{key:"onXHRProgress",value:function(){throw new Error("abstract")}},{key:"onXHRError",value:function(){this.emit("error")}},{key:"onXHRLoad",value:function(){this.eof=!0,this.emit("done")}}]),t}();e.exports=o},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._e={}}return n(e,[{key:"on",value:function(e,t){(this._e[e]||(this._e[e]=[])).push(t)}},{key:"off",value:function(e,t){var r=this._e[e]||[],n=r.indexOf(t);t>=0&&r.splice(n,1)}},{key:"emit",value:function(e,t){(this._e[e]||[]).slice().forEach(function(e){return e(t)})}}]),e}();e.exports=i},function(e,t){e.exports=function(e){e=""+e;var t=this;function r(e,t,r){var n=e.split(t,r).map(function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")});if("number"==typeof r)for(;n.length<r;)n.push(null);return n}t.major=null,t.minor=null,t.codecs=null;var n=r(e,";");if(n.length){var i=n.shift();if(i){var o=r(i,"/",2);t.major=o[0],t.minor=o[1]}n.forEach(function(e){var n=e.match(/^codecs\s*=\s*"(.*?)"$/);n&&(t.codecs=r(n[1],","))})}}},function(e,t){e.exports=function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}},function(e,t,r){var n=r(7),i={MEDIA_ERR_ABORTED:1,MEDIA_ERR_NETWORK:2,MEDIA_ERR_DECODE:3,MEDIA_ERR_SRC_NOT_SUPPORTED:4};function o(e,t){this.code=e,this.message=t}n(o,i),n(o.prototype,i),e.exports=o},function(e,t,r){var n=r(10)({loadedMetadata:!1,videoFormat:null,frameBuffer:null,cpuTime:0},{init:function(e){this.proxy("init",[],e)},processHeader:function(e,t){this.proxy("processHeader",[e],t,[e])},processFrame:function(e,t){this.proxy("processFrame",[e],t,[e])},close:function(){this.terminate()}});e.exports=n},function(e,t){e.exports=
/**
 * Proxy object for web worker interface for codec classes.
 *
 * Used by the high-level player interface.
 *
 * @author Brion Vibber <brion@pobox.com>
 * @copyright 2015
 * @license MIT-style
 */
function(e,t){return function(r,n,i){i=i||{};var o=this,a=function(){var e=new ArrayBuffer(1024),t=new Uint8Array(e);try{return r.postMessage({action:"transferTest",bytes:t},[e]),!e.byteLength}catch(e){return!1}}(),s={};for(var u in e)e.hasOwnProperty(u)&&function(t){s[t]=e[t],Object.defineProperty(o,t,{get:function(){return s[t]}})}(u);var f=0;for(var c in Object.defineProperty(o,"processing",{get:function(){return f>0}}),t)t.hasOwnProperty(c)&&(o[c]=t[c]);var d=0,l={};return this.proxy=function(e,t,n,i){if(!r)throw'Tried to call "'+e+'" method on closed proxy object';var o="callback-"+ ++d+"-"+e;n&&(l[o]=n);var s={action:e,callbackId:o,args:t||[]};f++,a?r.postMessage(s,i||[]):r.postMessage(s)},this.terminate=function(){r&&(r.terminate(),r=null,f=0,l={})},r.addEventListener("message",function(e){if(f--,"callback"===e.data.action){var t=e.data,r=t.callbackId,n=t.args,i=l[r];if(t.props)for(var o in t.props)t.props.hasOwnProperty(o)&&(s[o]=t.props[o]);i&&(delete l[r],i.apply(this,n))}}),o.proxy("construct",[n,i],function(){}),o}}},function(e,t,r){var n=r(10)({loadedMetadata:!1,audioFormat:null,audioBuffer:null,cpuTime:0},{init:function(e){this.proxy("init",[],e)},processHeader:function(e,t){this.proxy("processHeader",[e],t,[e])},processAudio:function(e,t){this.proxy("processAudio",[e],t,[e])},close:function(){this.terminate()}});e.exports=n},function(e,t,r){
/**
 * Proxy object for web worker interface for codec classes.
 *
 * Used by the high-level player interface.
 *
 * @author Brion Vibber <brion@pobox.com>
 * @copyright 2015
 * @license MIT-style
 */
var n=r(1);e.exports=function(e){e=e||{};var t=this,r=(encodeURIComponent("1.5.8-20180809032045-40c82e69"),"string"==typeof e.base&&e.base,"string"==typeof e.type&&e.type,!1),i=null,o=null,a=null,s=0;function u(e){var t=s;return function(r){s<=t&&e(r)}}var f=!1;Object.defineProperty(t,"loadedMetadata",{get:function(){return f}}),Object.defineProperty(t,"processing",{get:function(){return r}}),Object.defineProperty(t,"duration",{get:function(){return t.loadedMetadata?i.duration:NaN}}),Object.defineProperty(t,"hasAudio",{get:function(){return t.loadedMetadata&&!!a}}),Object.defineProperty(t,"audioReady",{get:function(){return t.hasAudio&&i.audioReady}}),Object.defineProperty(t,"audioTimestamp",{get:function(){return i.audioTimestamp}}),Object.defineProperty(t,"audioFormat",{get:function(){return t.hasAudio?a.audioFormat:null}}),Object.defineProperty(t,"audioBuffer",{get:function(){return t.hasAudio?a.audioBuffer:null}}),Object.defineProperty(t,"hasVideo",{get:function(){return t.loadedMetadata&&!!o}}),Object.defineProperty(t,"frameReady",{get:function(){return t.hasVideo&&i.frameReady}}),Object.defineProperty(t,"frameTimestamp",{get:function(){return i.frameTimestamp}}),Object.defineProperty(t,"keyframeTimestamp",{get:function(){return i.keyframeTimestamp}}),Object.defineProperty(t,"nextKeyframeTimestamp",{get:function(){return i.nextKeyframeTimestamp}}),Object.defineProperty(t,"videoFormat",{get:function(){return t.hasVideo?o.videoFormat:null}}),Object.defineProperty(t,"frameBuffer",{get:function(){return t.hasVideo?o.frameBuffer:null}}),Object.defineProperty(t,"seekable",{get:function(){return i.seekable}}),t.init=function(o){var a;a="video/webm"===e.type||"audio/webm"===e.type?e.wasm?"OGVDemuxerWebMW":"OGVDemuxerWebM":e.wasm?"OGVDemuxerOggW":"OGVDemuxerOgg",r=!0,n.loadClass(a,function(e){e().then(function(e){(i=e).onseek=function(e){t.onseek&&t.onseek(e)},i.init(function(){r=!1,o()})})})},t.close=function(){i&&(i.close(),i=null),o&&(o.close(),o=null),a&&(a.close(),a=null)},t.receiveInput=function(e,t){i.receiveInput(e,t)};var c={vorbis:e.wasm?"OGVDecoderAudioVorbisW":"OGVDecoderAudioVorbis",opus:e.wasm?"OGVDecoderAudioOpusW":"OGVDecoderAudioOpus"};var d={theora:e.wasm?"OGVDecoderVideoTheoraW":"OGVDecoderVideoTheora",vp8:e.wasm?"OGVDecoderVideoVP8W":e.threading?"OGVDecoderVideoVP8MT":"OGVDecoderVideoVP8",vp9:e.wasm?"OGVDecoderVideoVP9W":e.threading?"OGVDecoderVideoVP9MT":"OGVDecoderVideoVP9"};var l=!1,h=!1,p=!1,m=!1;return t.process=function(s){if(r)throw new Error("reentrancy fail on OGVWrapperCodec.process");function u(e){r=!1,s(e)}function v(){i.process(u)}r=!0,i.videoPackets.length,i.audioPackets.length,i.loadedMetadata&&!l?function(t){if(i.audioCodec){var o=c[i.audioCodec];r=!0,n.loadClass(o,function(e){var n={};i.audioFormat&&(n.audioFormat=i.audioFormat),e(n).then(function(e){(a=e).init(function(){h=a.loadedMetadata,r=!1,t()})})},{worker:e.worker})}else t()}(function(){!function(t){if(i.videoCodec){var a=d[i.videoCodec];r=!0,n.loadClass(a,function(n){var a={};i.videoFormat&&(a.videoFormat=i.videoFormat),e.memoryLimit&&(a.memoryLimit=e.memoryLimit),n(a).then(function(e){(o=e).init(function(){p=o.loadedMetadata,r=!1,t()})})},{worker:e.worker&&!e.threading})}else t()}(function(){l=!0,p=!o,m=(h=!a)&&p,u(!0)})}):l&&!h?a.loadedMetadata?(m=(h=!0)&&p,u(!0)):i.audioReady?i.dequeueAudioPacket(function(e){t.audioBytes+=e.byteLength,a.processHeader(e,function(e){u(!0)})}):v():h&&!p?o.loadedMetadata?(p=!0,m=h&&p,u(!0)):i.frameReady?(r=!0,i.dequeueVideoPacket(function(e){t.videoBytes+=e.byteLength,o.processHeader(e,function(){u(!0)})})):v():p&&!t.loadedMetadata&&m?(f=!0,u(!0)):!t.loadedMetadata||t.hasAudio&&!i.audioReady||t.hasVideo&&!i.frameReady?v():u(!0)},t.decodeFrame=function(e){var r=u(e),n=t.frameTimestamp,a=t.keyframeTimestamp;i.dequeueVideoPacket(function(e){t.videoBytes+=e.byteLength,o.processFrame(e,function(e){o.frameBuffer&&(o.frameBuffer.timestamp=n,o.frameBuffer.keyframeTimestamp=a),r(e)})})},t.decodeAudio=function(e){var r=u(e);i.dequeueAudioPacket(function(e){t.audioBytes+=e.byteLength,a.processAudio(e,r)})},t.discardFrame=function(e){i.dequeueVideoPacket(function(r){t.videoBytes+=r.byteLength,e()})},t.discardAudio=function(e){i.dequeueAudioPacket(function(r){t.audioBytes+=r.byteLength,e()})},t.flush=function(e){s++,i.flush(e)},t.getKeypointOffset=function(e,t){i.getKeypointOffset(e,t)},t.seekToKeypoint=function(e,t){i.seekToKeypoint(e,u(t))},t.onseek=null,Object.defineProperty(t,"demuxerCpuTime",{get:function(){return i?i.cpuTime:0}}),Object.defineProperty(t,"audioCpuTime",{get:function(){return a?a.cpuTime:0}}),Object.defineProperty(t,"videoCpuTime",{get:function(){return o?o.cpuTime:0}}),t.videoBytes=0,t.audioBytes=0,t}},function(e,t){e.exports=function(e){var t=e.start,r=e.end,n=0,i=this;function o(){return n=Math.floor((t+r)/2),e.process(t,r,n)}i.start=function(){return o(),i},i.left=function(){return r=n,o()},i.right=function(){return t=n,o()}}},function(e,t,r){e.exports=r.p+"dynamicaudio.swf?version=ec7d049d2ab54389eec08413c2b2e9c7"},function(e,t,r){var n;n=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}return r.m=e,r.c=t,r.p="",r(0)}([function(e,t,r){!function(){r(1);var t=r(2),n=r(4);function i(e){this._options=e||{},this._backend=null}i.prototype.rate=0,i.prototype.targetRate=0,i.prototype.channels=0,i.prototype.bufferSize=0,Object.defineProperty(i.prototype,"bufferDuration",{get:function(){return this.targetRate?this.bufferSize/this.targetRate:0}}),Object.defineProperty(i.prototype,"bufferThreshold",{get:function(){return this._backend?this._backend.bufferThreshold/this.targetRate:0},set:function(e){if(!this._backend)throw"Invalid state: AudioFeeder cannot set bufferThreshold before init";this._backend.bufferThreshold=Math.round(e*this.targetRate)}}),Object.defineProperty(i.prototype,"playbackPosition",{get:function(){return this._backend?this.getPlaybackState().playbackPosition:0}}),Object.defineProperty(i.prototype,"durationBuffered",{get:function(){return this._backend?this.getPlaybackState().samplesQueued/this.targetRate:0}}),Object.defineProperty(i.prototype,"muted",{get:function(){if(this._backend)return this._backend.muted;throw"Invalid state: cannot get mute before init"},set:function(e){if(!this._backend)throw"Invalid state: cannot set mute before init";this._backend.muted=e}}),i.prototype.mute=function(){this.muted=!0},i.prototype.unmute=function(){this.muted=!1},Object.defineProperty(i.prototype,"volume",{get:function(){if(this._backend)return this._backend.volume;throw"Invalid state: cannot get volume before init"},set:function(e){if(!this._backend)throw"Invalid state: cannot set volume before init";this._backend.volume=e}}),i.prototype.init=function(e,r){if(this.channels=e,this.rate=r,t.isSupported())this._backend=new t(e,r,this._options);else{if(!n.isSupported())throw"No supported backend";this._backend=new n(e,r,this._options)}this.targetRate=this._backend.rate,this.bufferSize=this._backend.bufferSize,this._backend.onstarved=function(){this.onstarved&&this.onstarved()}.bind(this),this._backend.onbufferlow=function(){this.onbufferlow&&this.onbufferlow()}.bind(this)},i.prototype._resample=function(e){var t=this.rate,r=this.channels,n=this._backend.rate,i=this._backend.channels;if(t==n&&r==i)return e;for(var o=[],a=0;a<i;a++){var s=a;a>=r&&(s=0);for(var u=e[s],f=new Float32Array(Math.round(u.length*n/t)),c=0;c<f.length;c++)f[c]=u[c*t/n|0];o.push(f)}return o},i.prototype.bufferData=function(e){if(!this._backend)throw"Invalid state: AudioFeeder cannot bufferData before init";var t=this._resample(e);this._backend.appendBuffer(t)},i.prototype.getPlaybackState=function(){if(this._backend)return this._backend.getPlaybackState();throw"Invalid state: AudioFeeder cannot getPlaybackState before init"},i.prototype.waitUntilReady=function(e){if(!this._backend)throw"Invalid state: AudioFeeder cannot waitUntilReady before init";this._backend.waitUntilReady(e)},i.prototype.start=function(){if(!this._backend)throw"Invalid state: AudioFeeder cannot start before init";this._backend.start()},i.prototype.stop=function(){if(!this._backend)throw"Invalid state: AudioFeeder cannot stop before init";this._backend.stop()},i.prototype.flush=function(){if(!this._backend)throw"Invalid state: AudioFeeder cannot flush before init";this._backend.flush()},i.prototype.close=function(){this._backend&&(this._backend.close(),this._backend=null)},i.prototype.onstarved=null,i.prototype.onbufferlow=null,i.isSupported=function(){return!!Float32Array&&(t.isSupported()||n.isSupported())},i.initSharedAudioContext=function(){return t.isSupported()?t.initSharedAudioContext():null},e.exports=i}()},function(e,t){
/**
	 * @file Abstraction around a queue of audio buffers.
	 *
	 * @author Brion Vibber <brion@pobox.com>
	 * @copyright (c) 2013-2016 Brion Vibber
	 * @license MIT
	 */
function r(e,t){if(e<1||e!==Math.round(e))throw"Invalid channel count for BufferQueue";this.channels=e,this.bufferSize=t,this.flush()}r.prototype.flush=function(){this._buffers=[],this._pendingBuffer=this.createBuffer(this.bufferSize),this._pendingPos=0},r.prototype.sampleCount=function(){var e=0;return this._buffers.forEach(function(t){e+=t[0].length}),e},r.prototype.createBuffer=function(e){for(var t=[],r=0;r<this.channels;r++)t[r]=new Float32Array(e);return t},r.prototype.validate=function(e){if(e.length!==this.channels)return!1;for(var t,r=0;r<e.length;r++){var n=e[r];if(!(n instanceof Float32Array))return!1;if(0==r)t=n.length;else if(n.length!==t)return!1}return!0},r.prototype.appendBuffer=function(e){if(!this.validate(e))throw"Invalid audio buffer passed to BufferQueue.appendBuffer";for(var t=e[0].length,r=0;r<t;r++){for(var n=0;n<this.channels;n++)this._pendingBuffer[n][this._pendingPos]=e[n][r];++this._pendingPos==this.bufferSize&&(this._buffers.push(this._pendingBuffer),this._pendingPos=0,this._pendingBuffer=this.createBuffer(this.bufferSize))}},r.prototype.prependBuffer=function(e){if(!this.validate(e))throw"Invalid audio buffer passed to BufferQueue.prependBuffer";var t=this._buffers.slice(0);t.push(this.trimBuffer(this._pendingBuffer,0,this._pendingPos)),this.flush(),this.appendBuffer(e);for(var r=0;r<t.length;r++)this.appendBuffer(t[r])},r.prototype.nextBuffer=function(){if(this._buffers.length)return this._buffers.shift();var e=this.trimBuffer(this._pendingBuffer,0,this._pendingPos);return this._pendingBuffer=this.createBuffer(this.bufferSize),this._pendingPos=0,e},r.prototype.trimBuffer=function(e,t,r){var n=e[0].length,i=t+Math.min(r,n);if(0==t&&i>=n)return e;for(var o=[],a=0;a<this.channels;a++)o[a]=e[a].subarray(t,i);return o},e.exports=r},function(e,t,r){
/**
	 * @file Web Audio API backend for AudioFeeder
	 * @author Brion Vibber <brion@pobox.com>
	 * @copyright (c) 2013-2016 Brion Vibber
	 * @license MIT
	 */
!function(){var t=window.AudioContext||window.webkitAudioContext,n=r(1),i=r(3);function o(e,t,r){var i=r.audioContext||o.initSharedAudioContext();if(this._context=i,this.output=r.output||i.destination,this.rate=i.sampleRate,this.channels=Math.min(e,2),r.bufferSize&&(this.bufferSize=0|r.bufferSize),this.bufferThreshold=2*this.bufferSize,this._bufferQueue=new n(this.channels,this.bufferSize),this._playbackTimeAtBufferTail=i.currentTime,this._queuedTime=0,this._delayedTime=0,this._dropped=0,this._liveBuffer=this._bufferQueue.createBuffer(this.bufferSize),i.createScriptProcessor)this._node=i.createScriptProcessor(this.bufferSize,0,this.channels);else{if(!i.createJavaScriptNode)throw new Error("Bad version of web audio API?");this._node=i.createJavaScriptNode(this.bufferSize,0,this.channels)}}o.prototype.bufferSize=4096,o.prototype.bufferThreshold=8192,o.prototype._volume=1,Object.defineProperty(o.prototype,"volume",{get:function(){return this._volume},set:function(e){this._volume=+e}}),o.prototype._muted=!1,Object.defineProperty(o.prototype,"muted",{get:function(){return this._muted},set:function(e){this._muted=!!e}}),o.prototype._audioProcess=function(e){var t,r,n,o,a;a="number"==typeof e.playbackTime?e.playbackTime:this._context.currentTime+this.bufferSize/this.rate;var s=this._playbackTimeAtBufferTail;if(s<a&&(this._delayedTime+=a-s),this._bufferQueue.sampleCount()<this.bufferSize&&this.onstarved&&this.onstarved(),this._bufferQueue.sampleCount()<this.bufferSize){for(t=0;t<this.channels;t++)for(n=e.outputBuffer.getChannelData(t),o=0;o<this.bufferSize;o++)n[o]=0;this._dropped++}else{var u=this.muted?0:this.volume,f=this._bufferQueue.nextBuffer();if(f[0].length<this.bufferSize)throw"Audio buffer not expected length.";for(t=0;t<this.channels;t++)for(r=f[t],this._liveBuffer[t].set(f[t]),n=e.outputBuffer.getChannelData(t),o=0;o<r.length;o++)n[o]=r[o]*u;this._queuedTime+=this.bufferSize/this.rate,this._playbackTimeAtBufferTail=a+this.bufferSize/this.rate,this._bufferQueue.sampleCount()<Math.max(this.bufferSize,this.bufferThreshold)&&this.onbufferlow&&i(this.onbufferlow.bind(this))}},o.prototype._samplesQueued=function(){return this._bufferQueue.sampleCount()+Math.floor(this._timeAwaitingPlayback()*this.rate)},o.prototype._timeAwaitingPlayback=function(){return Math.max(0,this._playbackTimeAtBufferTail-this._context.currentTime)},o.prototype.getPlaybackState=function(){return{playbackPosition:this._queuedTime-this._timeAwaitingPlayback(),samplesQueued:this._samplesQueued(),dropped:this._dropped,delayed:this._delayedTime}},o.prototype.waitUntilReady=function(e){e()},o.prototype.appendBuffer=function(e){this._bufferQueue.appendBuffer(e)},o.prototype.start=function(){this._node.onaudioprocess=this._audioProcess.bind(this),this._node.connect(this.output),this._playbackTimeAtBufferTail=this._context.currentTime},o.prototype.stop=function(){if(this._node){var e=this._timeAwaitingPlayback();if(e>0){var t=Math.round(e*this.rate),r=this._liveBuffer?this._liveBuffer[0].length:0;t>r?(this._bufferQueue.prependBuffer(this._liveBuffer),this._bufferQueue.prependBuffer(this._bufferQueue.createBuffer(t-r))):this._bufferQueue.prependBuffer(this._bufferQueue.trimBuffer(this._liveBuffer,r-t,t)),this._playbackTimeAtBufferTail-=e}this._node.onaudioprocess=null,this._node.disconnect()}},o.prototype.flush=function(){this._bufferQueue.flush()},o.prototype.close=function(){this.stop(),this._context=null},o.prototype.onstarved=null,o.prototype.onbufferlow=null,o.isSupported=function(){return!!t},o.sharedAudioContext=null,o.initSharedAudioContext=function(){if(!o.sharedAudioContext&&o.isSupported()){var e,r=new t;if(r.createScriptProcessor)e=r.createScriptProcessor(1024,0,2);else{if(!r.createJavaScriptNode)throw new Error("Bad version of web audio API?");e=r.createJavaScriptNode(1024,0,2)}e.connect(r.destination),e.disconnect(),o.sharedAudioContext=r}return o.sharedAudioContext},e.exports=o}()},function(e,t){e.exports=function(){if(void 0!==window.setImmediate)return window.setImmediate;if(window&&window.postMessage){var e=[];return window.addEventListener("message",function(t){if(t.source===window){var r=t.data;if("object"==typeof r&&r.nextTickBrowserPingMessage){var n=e.pop();n&&n()}}}),function(t){e.push(t),window.postMessage({nextTickBrowserPingMessage:!0},document.location.toString())}}return function(e){setTimeout(e,0)}}()},function(e,t,r){!function(){var t=r(5),n=r(3),i=function(e,r,i){var o={};"string"==typeof(i=i||{}).base&&(o.swf=i.base+"/"+t),i.bufferSize&&(this.bufferSize=0|i.bufferSize),this._flashaudio=new u(o),this._flashBuffer="",this._flushTimeout=null,this._flushInterval=40,this._cachedFlashState=null,this._cachedFlashTime=0,this._cachedFlashInterval=40,this._waitUntilReadyQueue=[],this.onready=function(){for(this._flashaudio.flashElement.setBufferSize(this.bufferSize),this._flashaudio.flashElement.setBufferThreshold(this.bufferThreshold);this._waitUntilReadyQueue.length;){this._waitUntilReadyQueue.shift().apply(this)}},this.onlog=function(e){console.log("AudioFeeder FlashBackend: "+e)},this.bufferThreshold=2*this.bufferSize;var a={ready:"sync",log:"sync",starved:"sync",bufferlow:"async"};this._callbackName="AudioFeederFlashBackendCallback"+this._flashaudio.id;window[this._callbackName]=function(e){var t=a[e],r=this["on"+e];t&&r&&("async"===t?n(r.bind(this)):(r.apply(this,Array.prototype.slice.call(arguments,1)),this._flushFlashBuffer()))}.bind(this)};i.prototype.rate=44100,i.prototype.channels=2,i.prototype.bufferSize=4096,i.prototype._bufferThreshold=8192,Object.defineProperty(i.prototype,"bufferThreshold",{get:function(){return this._bufferThreshold},set:function(e){this._bufferThreshold=0|e,this.waitUntilReady(function(){this._flashaudio.flashElement.setBufferThreshold(this._bufferThreshold)}.bind(this))}}),i.prototype._volume=1,Object.defineProperty(i.prototype,"volume",{get:function(){return this._volume},set:function(e){this._volume=+e,this.waitUntilReady(this._flashVolumeUpdate.bind(this))}}),i.prototype._muted=!1,Object.defineProperty(i.prototype,"muted",{get:function(){return this._muted},set:function(e){this._muted=!!e,this.waitUntilReady(this._flashVolumeUpdate.bind(this))}}),i.prototype._paused=!0,i.prototype._flashVolumeUpdate=function(){this._flashaudio&&this._flashaudio.flashElement&&this._flashaudio.flashElement.setVolume&&this._flashaudio.flashElement.setVolume(this.muted?0:this.volume)},i.prototype._resampleFlash=function(e){for(var t=e[0].length,r=new Float32Array(2*t),n=e[0],i=this.channels>1?e[1]:n,o=0;o<t;o++){var a=1*o|0,s=2*o;r[s]=n[a],r[s+1]=i[a]}return r};for(var o=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],a=[],s=0;s<256;s++)a[s]=o[(240&s)>>4]+o[15&s];function u(e){if(!(this instanceof arguments.callee))return new arguments.callee(arguments);"function"==typeof this.init&&this.init.apply(this,e&&e.callee?e:arguments)}i.prototype._flushFlashBuffer=function(){var e=this._flashBuffer,t=this._flashaudio.flashElement;this._cachedFlashState&&(this._cachedFlashState.samplesQueued+=e.length/16),this._flashBuffer="",this._flushTimeout=null,e.length>0&&this.waitUntilReady(function(){t.write(e)})},i.prototype.appendBuffer=function(e){var t=this._resampleFlash(e);if(t.length>0){var r=function(e){for(var t=new Uint8Array(e),r="",n=t.length,i=0;i<n;i++)r+=a[t[i]];return r}(t.buffer);this._flashBuffer+=r,this._flushTimeout||(this._flushTimeout=setTimeout(this._flushFlashBuffer.bind(this),this._flushInterval))}},i.prototype.getPlaybackState=function(){if(this._flashaudio&&this._flashaudio.flashElement&&this._flashaudio.flashElement.write){var e,t=Date.now(),r=this._paused?0:t-this._cachedFlashTime;if(this._cachedFlashState&&r<this._cachedFlashInterval){var n=this._cachedFlashState;e={playbackPosition:n.playbackPosition+r/1e3,samplesQueued:n.samplesQueued-Math.max(0,Math.round(r*this.rate/1e3)),dropped:n.dropped,delayed:n.delayed}}else e=this._flashaudio.flashElement.getPlaybackState(),this._cachedFlashState=e,this._cachedFlashTime=t;return e.samplesQueued+=this._flashBuffer.length/16,e}return{playbackPosition:0,samplesQueued:0,dropped:0,delayed:0}},i.prototype.waitUntilReady=function(e){this._flashaudio&&this._flashaudio.flashElement.write?e.apply(this):this._waitUntilReadyQueue.push(e)},i.prototype.start=function(){this._flashaudio.flashElement.start(),this._paused=!1,this._cachedFlashState=null},i.prototype.stop=function(){this._flashaudio.flashElement.stop(),this._paused=!0,this._cachedFlashState=null},i.prototype.flush=function(){this._flashaudio.flashElement.flush(),this._cachedFlashState=null},i.prototype.close=function(){this.stop();var e=this._flashaudio.flashWrapper;e.parentNode.removeChild(e),this._flashaudio=null,delete window[this._callbackName]},i.prototype.onstarved=null,i.prototype.onbufferlow=null,i.isSupported=function(){if(-1!==navigator.userAgent.indexOf("Trident"))try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash");return!0}catch(e){return!1}return!1},u.nextId=1,u.prototype={nextId:null,swf:t,flashWrapper:null,flashElement:null,init:function(e){this.id=u.nextId++,e&&void 0!==e.swf&&(this.swf=e.swf),this.flashWrapper=document.createElement("div"),this.flashWrapper.id="dynamicaudio-flashwrapper-"+this.id;var t=this.flashWrapper.style;t.position="fixed",t.width="11px",t.height="11px",t.bottom=t.left="0px",t.overflow="hidden",this.flashElement=document.createElement("div"),this.flashElement.id="dynamicaudio-flashelement-"+this.id,this.flashWrapper.appendChild(this.flashElement),document.body.appendChild(this.flashWrapper);var r=this.flashElement.id,n='<param name="FlashVars" value="objectId='+this.id+'">';this.flashWrapper.innerHTML="<object id='"+r+"' width='10' height='10' type='application/x-shockwave-flash' data='"+this.swf+"' style='visibility: visible;'><param name='allowscriptaccess' value='always'>"+n+"</object>",this.flashElement=document.getElementById(r)}},e.exports=i}()},function(e,t,r){e.exports=r.p+"dynamicaudio.swf?version=ec7d049d2ab54389eec08413c2b2e9c7"}])},e.exports=n()},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(n):void 0};var o=r(4),a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o),n(t,[{key:"initXHR",value:function(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initXHR",this).call(this),this.xhr.responseType="text",this.xhr.overrideMimeType("text/plain; charset=x-user-defined")}},{key:"onXHRProgress",value:function(){var e=this.xhr.responseText.slice(this.bytesRead);e.length>0&&(this.bytesRead+=e.length,this.emit("buffer",e))}},{key:"onXHRLoad",value:function(){this.onXHRProgress(),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onXHRLoad",this).call(this)}}]),t}();a.supported=function(){try{return!!(new XMLHttpRequest).overrideMimeType}catch(e){return!1}},e.exports=a},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(n):void 0};var o=r(3),a="ms-stream",s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.stream=null,r.streamReader=null,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o),n(t,[{key:"initXHR",value:function(){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initXHR",this).call(this),this.xhr.responseType=a}},{key:"onXHRStart",value:function(){var e=this;this.xhr.addEventListener("readystatechange",function t(){3===e.xhr.readyState&&(e.stream=e.xhr.response,e.xhr.removeEventListener("readystatechange",t),e.emit("open"))})}},{key:"waitForStream",value:function(){var e=this;return new Promise(function(t,r){e.stream?t(e.stream):function(){var n=null;e._onAbort=function(e){n(),r(e)};var i=function(){t(e.stream)};n=function(){e.off("open",i),e._onAbort=null},e.on("open",i)}()})}},{key:"bufferToOffset",value:function(e){var t=this;return this.waitForStream().then(function(r){return new Promise(function(n,i){if(t.streamReader)throw new Error("cannot trigger read when reading");if(t.offset>=e||t.eof)n();else{var o=e-t.offset;t.streamReader=new MSStreamReader,t.streamReader.onload=function(e){t.streamReader=null;var r=e.target.result;r.byteLength>0?(t.bytesRead+=r.byteLength,t.emit("buffer",r)):(t.eof=!0,t.emit("done")),n()},t.streamReader.onerror=function(){t.streamReader=null,t.stream=null,t.emit("error"),i(new Error("mystery error streaming"))},t._onAbort=function(e){t.streamReader.abort(),t.streamReader=null,t.stream=null,t.emit("error"),i(e)},t.streamReader.readAsArrayBuffer(r,o)}})})}},{key:"abort",value:function(){this.streamReader&&(this.streamReader.abort(),this.streamReader=null),this.stream&&(this.stream.msClose(),this.stream=null),i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"abort",this).call(this)}}]),t}();s.supported=function(){try{var e=new XMLHttpRequest;return e.open("GET","/robots.txt"),e.responseType=a,e.responseType===a}catch(e){return!1}},e.exports=s},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=r(4),o="moz-chunked-arraybuffer",a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i),n(t,[{key:"initXHR",value:function(){(function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(n):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initXHR",this).call(this),this.xhr.responseType=o}},{key:"onXHRProgress",value:function(){var e=this.xhr.response;this.bytesRead+=e.byteLength,this.emit("buffer",e)}}]),t}();a.supported=function(){try{var e=new XMLHttpRequest;return e.responseType=o,e.responseType===o}catch(e){return!1}},e.exports=a},function(e,t,r){"use strict";var n=r(18),i=r(17),o=r(16);var a=null;e.exports=function(e){if(a||(a=n.supported()?n:o.supported()?o:i.supported()?i:null),!a)throw new Error("No supported backend class");return new a(e)}},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.buffer,n=void 0===r?void 0:r,i=t.string,o=void 0===i?void 0:i,a=t.start,s=void 0===a?0:a,u=t.end,f=void 0===u?s+(n?n.byteLength:o?o.length:0):u,c=t.prev,d=void 0===c?null:c,l=t.next,h=void 0===l?null:l,p=t.eof,m=void 0!==p&&p,v=t.empty,y=void 0===v?!(n||o):v,b=t.timestamp,g=void 0===b?Date.now():b;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.start=s,this.end=f,this.prev=d,this.next=h,this.eof=m,this.empty=y,this.timestamp=g,this.buffer=n,this.string=o,Object.defineProperty(this,"length",{get:function(){return this.end-this.start}})}return n(e,[{key:"contains",value:function(e){return e>=this.start&&(e<this.end||this.eof)}},{key:"readBytes",value:function(e,t,r){var n=t-this.start,i=r-t;if(this.buffer){var o=new Uint8Array(this.buffer,n,i);e.set(o)}else{if(!this.string)throw new Error("invalid state");for(var a=this.string,s=0;s<i;s++)e[s]=a.charCodeAt(n+s)}this.timestamp=Date.now()}},{key:"split",value:function(t){if(!this.empty||!this.contains(t))throw new Error("invalid split");var r=new e({start:this.start,end:t}),n=new e({start:t,end:this.eof?t:this.end,eof:this.eof});return r.next=n,n.prev=r,[r,n]}},{key:"first",value:function(e){for(var t=this;t;t=t.next)if(e(t))return t;return null}},{key:"last",value:function(e){for(var t=null,r=this;r&&e(r);r=r.next)t=r;return t}}]),e}();e.exports=i},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=r(20),o=function(){function e(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).cacheSize,r=void 0===t?0:t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new i({eof:!0});this.head=n,this.tail=n,this.readOffset=0,this.readCursor=n,this.writeOffset=0,this.writeCursor=n,this.cacheSize=r}return n(e,[{key:"bytesReadable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,t=this.readOffset,r=this.readCursor.last(function(r){return!r.empty&&r.start<=t+e});return r?Math.min(e,r.end-t):0}},{key:"bytesWritable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,t=this.writeOffset,r=this.writeCursor;if(r.eof)return e;var n=r.last(function(r){return r.empty&&r.start<=t+e});return n?Math.min(e,n.end-t):0}},{key:"seekRead",value:function(e){var t=this.head.first(function(t){return t.contains(e)});if(!t)throw new Error("read seek out of range");this.readOffset=e,this.readCursor=t}},{key:"seekWrite",value:function(e){var t=this.head.first(function(t){return t.contains(e)});if(!t)throw new Error("write seek out of range");this.writeOffset=e,this.writeCursor=t}},{key:"readBytes",value:function(e){for(var t=e.byteLength,r=this.bytesReadable(t),n=this.readOffset,i=n+r,o=n,a=this.readCursor;a&&!a.empty&&!(a.start>=i);a=a.next){var s=Math.min(i,a.end),u=e.subarray(o-n,s-n);a.readBytes(u,o,s),o=s}return this.readOffset=o,this.readCursor=this.readCursor.first(function(e){return e.contains(o)}),r}},{key:"write",value:function(e){var t=this.bufferItem(e),r=this.writeCursor;if(!r.empty)throw new Error("write cursor not empty");if(!r.contains(t.end)&&r.end!==t.end)throw new Error("write cursor too small");r.start<t.start&&(this.split(r,t.start),r=this.writeCursor),(t.end<r.end||r.eof)&&(this.split(r,t.end),r=this.writeCursor),this.splice(r,r,t,t),this.writeOffset=t.end,this.writeCursor=t.next,this.gc()}},{key:"bufferItem",value:function(e){if(e instanceof ArrayBuffer)return new i({start:this.writeOffset,end:this.writeOffset+e.byteLength,buffer:e});if("string"==typeof e)return new i({start:this.writeOffset,end:this.writeOffset+e.length,string:e});throw new Error("invalid input to write")}},{key:"split",value:function(e,t){var r=e.split(t);this.splice(e,e,r[0],r[1])}},{key:"ranges",value:function(){for(var e=[],t=this.head;t;t=t.next)if(!t.empty){var r=t;t=t.last(function(e){return!e.empty}),e.push([r.start,t.end])}return e}},{key:"gc",value:function(){for(var e=0,t=[],r=this.head;r;r=r.next)r.empty||(e+=r.length,(r.end<this.readOffset||r.start>this.readOffset+this.chunkSize)&&t.push(r));if(e>this.cacheSize){t.sort(function(e,t){return e.timestamp-t.timestamp});for(var n=0;n<t.length;n++){var i=t[n];if(e<=this.cacheSize)break;this.remove(i),e-=i.length}}}},{key:"remove",value:function(e){var t=new i({start:e.start,end:e.end});this.splice(e,e,t,t),(e=t).prev&&e.prev.empty&&(e=this.consolidate(e.prev)),e.next&&e.next.empty&&!e.next.eof&&(e=this.consolidate(e)),0===e.start&&(this.head=e)}},{key:"consolidate",value:function(e){var t=e.last(function(e){return e.empty&&!e.eof}),r=new i({start:e.start,end:t.end});return this.splice(e,t,r,r),r}},{key:"splice",value:function(e,t,r,n){var i=this;if(e.start!==r.start)throw new Error("invalid splice head");if(!(t.end===n.end||t.eof&&n.eof))throw new Error("invalid splice tail");var o=e.prev,a=t.next;e.prev=null,t.next=null,o&&(o.next=r,r.prev=o),a&&(a.prev=n,n.next=a),e===this.head&&(this.head=r),t===this.tail&&(this.tail=n),this.readCursor=this.head.first(function(e){return e.contains(i.readOffset)}),this.writeCursor=this.head.first(function(e){return e.contains(i.writeOffset)})}},{key:"eof",get:function(){return this.readCursor.eof}}]),e}();e.exports=o},function(e,t,r){"use strict";e.exports=r(21)},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();r(5);var i=r(22),o=r(19),a=function(){function e(t){var r=t.url,n=void 0===r?"":r,o=t.chunkSize,a=void 0===o?1048576:o,s=t.cacheSize,u=void 0===s?0:s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.length=-1,this.loaded=!1,this.loading=!1,this.seekable=!1,this.buffering=!1,this.seeking=!1,Object.defineProperties(this,{offset:{get:function(){return this._cache.readOffset}},eof:{get:function(){return this.length===this._cache.readOffset}}}),this.url=n,this.headers={},this._cache=new i({cacheSize:u}),this._backend=null,this._cachever=0,this._chunkSize=a}return n(e,[{key:"load",value:function(){var e=this;return new Promise(function(t,r){if(e.loading)throw new Error("cannot load when loading");if(e.loaded)throw new Error("cannot load when loaded");e.loading=!0,e._openBackend().then(function(r){e.seekable=r.seekable,e.headers=r.headers,e.length=r.length,e.loaded=!0,e.loading=!1,t()}).catch(function(t){"AbortError"!==t.name&&(e.loading=!1),r(t)})})}},{key:"_openBackend",value:function(){var e=this;return new Promise(function(t,r){if(e._backend)t(e._backend);else if(e.eof)r(new Error("cannot open at end of file"));else{var n=e._cache,i=e._chunkSize,a=n.bytesReadable(i),s=n.readOffset+a;if(n.seekWrite(s),e.length>=0&&s>=e.length)return void t(null);var u=e._clampToLength(n.writeOffset+n.bytesWritable(i))-n.writeOffset;0===u?t(null):(f=e._backend=new o({url:e.url,offset:e._cache.writeOffset,length:u,cachever:e._cachever}),c=null,d=function(){f!==e._backend?(c(),r(new Error("invalid state"))):(f.on("buffer",function(t){f===e._backend&&e._cache.write(t)}),f.on("done",function(){f===e._backend&&(-1===e.length&&(e.length=e._backend.offset+e._backend.bytesRead),e._backend=null)}),t(f))},l=function(t){f!==e._backend?r(new Error("invalid state")):(e._backend=null,r(t))},c=function(){f.off("open",d),f.off("error",l)},f.on("open",d),f.on("error",l),f.on("cachever",function(){e._cachever++}),f.load())}var f,c,d,l})}},{key:"_readAhead",value:function(){var e=this;return new Promise(function(t,r){e._backend||e.eof?t():e._openBackend().then(function(){t()}).catch(function(e){r(e)})})}},{key:"seek",value:function(e){var t=this;return new Promise(function(r,n){if(!t.loaded||t.buffering||t.seeking)throw new Error("invalid state");if(e!==(0|e)||e<0)throw new Error("invalid input");if(t.length>=0&&e>t.length)throw new Error("seek past end of file");if(!t.seekable)throw new Error("seek on non-seekable stream");t._backend&&t.abort(),t._cache.seekRead(e),t._cache.seekWrite(e),t._readAhead().then(r).catch(n)})}},{key:"read",value:function(e){var t=this;return this.buffer(e).then(function(e){return t.readSync(e)})}},{key:"readSync",value:function(e){var t=this.bytesAvailable(e),r=new Uint8Array(t);if(this.readBytes(r)!==t)throw new Error("failed to read expected data");return r.buffer}},{key:"readBytes",value:function(e){if(!this.loaded||this.buffering||this.seeking)throw new Error("invalid state");if(!(e instanceof Uint8Array))throw new Error("invalid input");var t=this._cache.readBytes(e);return this._readAhead(),t}},{key:"buffer",value:function(e){var t=this;return new Promise(function(r,n){if(!t.loaded||t.buffering||t.seeking)throw new Error("invalid state");if(e!==(0|e)||e<0)throw new Error("invalid input");var i=t._clampToLength(t.offset+e),o=i-t.offset,a=t.bytesAvailable(o);a>=o?r(a):(t.buffering=!0,t._openBackend().then(function(r){return r?r.bufferToOffset(i).then(function(){return t.buffering=!1,t.buffer(e)}):Promise.resolve(a)}).then(function(e){t.buffering=!1,r(e)}).catch(function(e){"AbortError"!==e.name&&(t.buffering=!1),n(e)}))})}},{key:"bytesAvailable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0;return this._cache.bytesReadable(e)}},{key:"abort",value:function(){this.loading&&(this.loading=!1),this.buffering&&(this.buffering=!1),this.seeking&&(this.seeking=!1),this._backend&&(this._backend.abort(),this._backend=null)}},{key:"getBufferedRanges",value:function(){return this._cache.ranges()}},{key:"_clampToLength",value:function(e){return this.length<0?e:Math.min(this.length,e)}}]),e}();e.exports=a},function(e,t){e.exports={vertex:"precision lowp float;\n\nattribute vec2 aPosition;\nattribute vec2 aLumaPosition;\nattribute vec2 aChromaPosition;\nvarying vec2 vLumaPosition;\nvarying vec2 vChromaPosition;\nvoid main() {\n    gl_Position = vec4(aPosition, 0, 1);\n    vLumaPosition = aLumaPosition;\n    vChromaPosition = aChromaPosition;\n}\n",fragment:"// inspired by https://github.com/mbebenita/Broadway/blob/master/Player/canvas.js\n\nprecision lowp float;\n\nuniform sampler2D uTextureY;\nuniform sampler2D uTextureCb;\nuniform sampler2D uTextureCr;\nvarying vec2 vLumaPosition;\nvarying vec2 vChromaPosition;\nvoid main() {\n   // Y, Cb, and Cr planes are uploaded as LUMINANCE textures.\n   float fY = texture2D(uTextureY, vLumaPosition).x;\n   float fCb = texture2D(uTextureCb, vChromaPosition).x;\n   float fCr = texture2D(uTextureCr, vChromaPosition).x;\n\n   // Premultipy the Y...\n   float fYmul = fY * 1.1643828125;\n\n   // And convert that to RGB!\n   gl_FragColor = vec4(\n     fYmul + 1.59602734375 * fCr - 0.87078515625,\n     fYmul - 0.39176171875 * fCb - 0.81296875 * fCr + 0.52959375,\n     fYmul + 2.017234375   * fCb - 1.081390625,\n     1\n   );\n}\n",vertexStripe:"precision lowp float;\n\nattribute vec2 aPosition;\nattribute vec2 aTexturePosition;\nvarying vec2 vTexturePosition;\n\nvoid main() {\n    gl_Position = vec4(aPosition, 0, 1);\n    vTexturePosition = aTexturePosition;\n}\n",fragmentStripe:"// extra 'stripe' texture fiddling to work around IE 11's poor performance on gl.LUMINANCE and gl.ALPHA textures\n\nprecision lowp float;\n\nuniform sampler2D uStripe;\nuniform sampler2D uTexture;\nvarying vec2 vTexturePosition;\nvoid main() {\n   // Y, Cb, and Cr planes are mapped into a pseudo-RGBA texture\n   // so we can upload them without expanding the bytes on IE 11\n   // which doesn't allow LUMINANCE or ALPHA textures\n   // The stripe textures mark which channel to keep for each pixel.\n   // Each texture extraction will contain the relevant value in one\n   // channel only.\n\n   float fLuminance = dot(\n      texture2D(uStripe, vTexturePosition),\n      texture2D(uTexture, vTexturePosition)\n   );\n\n   gl_FragColor = vec4(fLuminance, fLuminance, fLuminance, 1);\n}\n"}},function(e,t,r){!function(){"use strict";var t=r(0),n=r(24);function i(e){var t,r,o=this,a=e.getContext("webgl")||e.getContext("experimental-webgl");if(null===a)throw new Error("WebGL unavailable");function s(e,t){var r=a.createShader(e);if(a.shaderSource(r,t),a.compileShader(r),!a.getShaderParameter(r,a.COMPILE_STATUS)){var n=a.getShaderInfoLog(r);throw a.deleteShader(r),new Error("GL shader compilation for "+e+" failed: "+n)}return r}var u,f,c,d,l,h,p,m,v,y,b=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),g={},w={},_={};function T(e){return g[e]||(g[e]=a.createTexture()),g[e]}function E(e,t,r,n){var o=T(e);if(a.activeTexture(a.TEXTURE0),i.stripe){var s=!g[e+"_temp"],u=T(e+"_temp");a.bindTexture(a.TEXTURE_2D,u),s?(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,t/4,r,0,a.RGBA,a.UNSIGNED_BYTE,n)):a.texSubImage2D(a.TEXTURE_2D,0,0,0,t/4,r,a.RGBA,a.UNSIGNED_BYTE,n);var f=g[e+"_stripe"],c=!f;c&&(f=T(e+"_stripe")),a.bindTexture(a.TEXTURE_2D,f),c&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,t,1,0,a.RGBA,a.UNSIGNED_BYTE,function(e){if(_[e])return _[e];for(var t=e,r=new Uint32Array(t),n=0;n<t;n+=4)r[n]=255,r[n+1]=65280,r[n+2]=16711680,r[n+3]=4278190080;return _[e]=new Uint8Array(r.buffer)}(t)))}else a.bindTexture(a.TEXTURE_2D,o),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.LUMINANCE,t,r,0,a.LUMINANCE,a.UNSIGNED_BYTE,n)}function A(e,t,n){var i=g[e];a.useProgram(r);var o=w[e];o||(a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,i),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,t,n,0,a.RGBA,a.UNSIGNED_BYTE,null),o=w[e]=a.createFramebuffer()),a.bindFramebuffer(a.FRAMEBUFFER,o),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,i,0);var s=g[e+"_temp"];a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,s),a.uniform1i(h,1);var p=g[e+"_stripe"];a.activeTexture(a.TEXTURE2),a.bindTexture(a.TEXTURE_2D,p),a.uniform1i(l,2),a.bindBuffer(a.ARRAY_BUFFER,u),a.enableVertexAttribArray(f),a.vertexAttribPointer(f,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,c),a.enableVertexAttribArray(d),a.vertexAttribPointer(d,2,a.FLOAT,!1,0,0),a.viewport(0,0,t,n),a.drawArrays(a.TRIANGLES,0,b.length/2),a.bindFramebuffer(a.FRAMEBUFFER,null)}function R(e,r,n){a.activeTexture(r),a.bindTexture(a.TEXTURE_2D,g[e]),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.uniform1i(a.getUniformLocation(t,e),n)}function x(e,t){var r=s(a.VERTEX_SHADER,e),n=s(a.FRAGMENT_SHADER,t),i=a.createProgram();if(a.attachShader(i,r),a.attachShader(i,n),a.linkProgram(i),!a.getProgramParameter(i,a.LINK_STATUS)){var o=a.getProgramInfoLog(i);throw a.deleteProgram(i),new Error("GL program linking failed: "+o)}return i}return o.drawFrame=function(s){var g=s.format,w=!t||e.width!==g.displayWidth||e.height!==g.displayHeight;if(w&&(e.width=g.displayWidth,e.height=g.displayHeight,o.clear()),t||function(){if(i.stripe){r=x(n.vertexStripe,n.fragmentStripe),a.getAttribLocation(r,"aPosition"),c=a.createBuffer();var e=new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]);a.bindBuffer(a.ARRAY_BUFFER,c),a.bufferData(a.ARRAY_BUFFER,e,a.STATIC_DRAW),d=a.getAttribLocation(r,"aTexturePosition"),l=a.getUniformLocation(r,"uStripe"),h=a.getUniformLocation(r,"uTexture")}t=x(n.vertex,n.fragment),u=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,u),a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW),f=a.getAttribLocation(t,"aPosition"),p=a.createBuffer(),m=a.getAttribLocation(t,"aLumaPosition"),v=a.createBuffer(),y=a.getAttribLocation(t,"aChromaPosition")}(),w){var _=function(e,t,r){var n=g.cropLeft/r,i=(g.cropLeft+g.cropWidth)/r,o=(g.cropTop+g.cropHeight)/g.height,s=g.cropTop/g.height,u=new Float32Array([n,o,i,o,n,s,n,s,i,o,i,s]);a.bindBuffer(a.ARRAY_BUFFER,e),a.bufferData(a.ARRAY_BUFFER,u,a.STATIC_DRAW)};_(p,0,s.y.stride),_(v,0,s.u.stride*g.width/g.chromaWidth)}E("uTextureY",s.y.stride,g.height,s.y.bytes),E("uTextureCb",s.u.stride,g.chromaHeight,s.u.bytes),E("uTextureCr",s.v.stride,g.chromaHeight,s.v.bytes),i.stripe&&(A("uTextureY",s.y.stride,g.height),A("uTextureCb",s.u.stride,g.chromaHeight),A("uTextureCr",s.v.stride,g.chromaHeight)),a.useProgram(t),a.viewport(0,0,e.width,e.height),R("uTextureY",a.TEXTURE0,0),R("uTextureCb",a.TEXTURE1,1),R("uTextureCr",a.TEXTURE2,2),a.bindBuffer(a.ARRAY_BUFFER,u),a.enableVertexAttribArray(f),a.vertexAttribPointer(f,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,p),a.enableVertexAttribArray(m),a.vertexAttribPointer(m,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,v),a.enableVertexAttribArray(y),a.vertexAttribPointer(y,2,a.FLOAT,!1,0,0),a.drawArrays(a.TRIANGLES,0,b.length/2)},o.clear=function(){a.viewport(0,0,e.width,e.height),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT)},o.clear(),o}i.stripe=-1!==navigator.userAgent.indexOf("Windows"),i.isAvailable=function(){var e,t=document.createElement("canvas");t.width=1,t.height=1;var r={alpha:!1,depth:!1,stencil:!1,antialias:!1,preferLowPowerToHighPerformance:!0};try{e=t.getContext("webgl",r)||t.getContext("experimental-webgl",r)}catch(e){return!1}if(e){var n=e.TEXTURE0,o=e.createTexture(),a=new Uint8Array(16),s=i.stripe?1:4,u=i.stripe?e.RGBA:e.LUMINANCE,f=i.stripe?e.NEAREST:e.LINEAR;return e.activeTexture(n),e.bindTexture(e.TEXTURE_2D,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,f),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,f),e.texImage2D(e.TEXTURE_2D,0,u,s,4,0,u,e.UNSIGNED_BYTE,a),!e.getError()}return!1},i.prototype=Object.create(t.prototype),e.exports=i}()},function(e,t){!function(){"use strict";
/**
   * Convert a ratio into a bit-shift count; for instance a ratio of 2
   * becomes a bit-shift of 1, while a ratio of 1 is a bit-shift of 0.
   *
   * @author Brion Vibber <brion@pobox.com>
   * @copyright 2016
   * @license MIT-style
   *
   * @param {number} ratio - the integer ratio to convert.
   * @returns {number} - number of bits to shift to multiply/divide by the ratio.
   * @throws exception if given a non-power-of-two
   */e.exports=function(e){for(var t=0,r=e>>1;0!=r;)r>>=1,t++;if(e!==1<<t)throw"chroma plane dimensions must be power of 2 ratio to luma plane dimensions; got "+e;return t}}()},function(e,t,r){!function(){"use strict";var t=r(26);
/**
	 * Basic YCbCr->RGB conversion
	 *
	 * @author Brion Vibber <brion@pobox.com>
	 * @copyright 2014-2016
	 * @license MIT-style
	 *
	 * @param {YUVFrame} buffer - input frame buffer
	 * @param {Uint8ClampedArray} output - array to draw RGBA into
	 * Assumes that the output array already has alpha channel set to opaque.
	 */e.exports={convertYCbCr:function(e,r){var n=e.format.width,i=e.format.height,o=t(e.format.width/e.format.chromaWidth),a=t(e.format.height/e.format.chromaHeight),s=e.y.bytes,u=e.u.bytes,f=e.v.bytes,c=e.y.stride,d=e.u.stride,l=e.v.stride,h=4*n,p=0,m=0,v=0,y=0,b=0,g=0,w=0,_=0,T=0,E=0,A=0,R=0,x=0,O=0,k=0,P=0,S=0,C=0;if(1==o&&1==a)for(w=0,_=h,C=0,P=0;P<i;P+=2){for(v=(m=P*c)+c,y=C*d,b=C*l,k=0;k<n;k+=2)T=u[y++],R=409*(E=f[b++])-57088,x=100*T+208*E-34816,O=516*T-70912,A=298*s[m++],r[w++]=A+R>>8,r[w++]=A-x>>8,r[w++]=A+O>>8,w++,A=298*s[m++],r[w++]=A+R>>8,r[w++]=A-x>>8,r[w++]=A+O>>8,w++,A=298*s[v++],r[_++]=A+R>>8,r[_++]=A-x>>8,r[_++]=A+O>>8,_++,A=298*s[v++],r[_++]=A+R>>8,r[_++]=A-x>>8,r[_++]=A+O>>8,_++;w+=h,_+=h,C++}else for(g=0,P=0;P<i;P++)for(S=0,p=P*c,y=(C=P>>a)*d,b=C*l,k=0;k<n;k++)T=u[y+(S=k>>o)],R=409*(E=f[b+S])-57088,x=100*T+208*E-34816,O=516*T-70912,A=298*s[p++],r[g++]=A+R>>8,r[g++]=A-x>>8,r[g++]=A+O>>8,g++}}}()},function(e,t,r){!function(){"use strict";var t=r(0),n=r(27);function i(e){var t=e.getContext("2d"),r=null,i=null,o=null;return this.drawFrame=function(a){var s=a.format;e.width===s.displayWidth&&e.height===s.displayHeight||(e.width=s.displayWidth,e.height=s.displayHeight),null!==r&&r.width==s.width&&r.height==s.height||function(e,n){for(var i=(r=t.createImageData(e,n)).data,o=e*n*4,a=0;a<o;a+=4)i[a+3]=255}(s.width,s.height),n.convertYCbCr(a,r.data);var u,f,c,d=s.cropWidth!=s.displayWidth||s.cropHeight!=s.displayHeight;d?(i||(f=s.cropWidth,c=s.cropHeight,(i=document.createElement("canvas")).width=f,i.height=c,o=i.getContext("2d")),u=o):u=t,u.putImageData(r,0,0,s.cropLeft,s.cropTop,s.cropWidth,s.cropHeight),d&&t.drawImage(i,0,0,s.displayWidth,s.displayHeight)},this.clear=function(){t.clearRect(0,0,e.width,e.height)},this}i.prototype=Object.create(t.prototype),e.exports=i}()},function(e,t,r){!function(){"use strict";var t=r(0),n=r(28),i=r(25),o={FrameSink:t,SoftwareFrameSink:n,WebGLFrameSink:i,attach:function(e,t){return("webGL"in(t=t||{})?t.webGL:i.isAvailable())?new i(e,t):new n(e,t)}};e.exports=o}()},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t){var r,n,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var u,f=[],c=!1,d=-1;function l(){c&&u&&(c=!1,u.length?f=u.concat(f):d=-1,f.length&&h())}function h(){if(!c){var e=s(l);c=!0;for(var t=f.length;t;){for(u=f,f=[];++d<t;)u&&u[d].run();d=-1,t=f.length}u=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];f.push(new p(e,t)),1!==f.length||c||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){(function(t,r){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.4+314e4831
 */var n;n=function(){"use strict";function e(e){return"function"==typeof e}var n=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=0,o=void 0,a=void 0,s=function(e,t){p[i]=e,p[i+1]=t,2===(i+=2)&&(a?a(m):w())};var u="undefined"!=typeof window?window:void 0,f=u||{},c=f.MutationObserver||f.WebKitMutationObserver,d="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function h(){var e=setTimeout;return function(){return e(m,1)}}var p=new Array(1e3);function m(){for(var e=0;e<i;e+=2){(0,p[e])(p[e+1]),p[e]=void 0,p[e+1]=void 0}i=0}var v,y,b,g,w=void 0;function _(e,t){var r=this,n=new this.constructor(A);void 0===n[E]&&N(n);var i=r._state;if(i){var o=arguments[i-1];s(function(){return F(i,n,o,r._result)})}else I(r,n,e,t);return n}function T(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(A);return C(t,e),t}d?w=function(){return t.nextTick(m)}:c?(y=0,b=new c(m),g=document.createTextNode(""),b.observe(g,{characterData:!0}),w=function(){g.data=y=++y%2}):l?((v=new MessageChannel).port1.onmessage=m,w=function(){return v.port2.postMessage(0)}):w=void 0===u?function(){try{var e=Function("return this")().require("vertx");return void 0!==(o=e.runOnLoop||e.runOnContext)?function(){o(m)}:h()}catch(e){return h()}}():h();var E=Math.random().toString(36).substring(2);function A(){}var R=void 0,x=1,O=2,k={error:null};function P(e){try{return e.then}catch(e){return k.error=e,k}}function S(t,r,n){r.constructor===t.constructor&&n===_&&r.constructor.resolve===T?function(e,t){t._state===x?B(e,t._result):t._state===O?L(e,t._result):I(t,void 0,function(t){return C(e,t)},function(t){return L(e,t)})}(t,r):n===k?(L(t,k.error),k.error=null):void 0===n?B(t,r):e(n)?function(e,t,r){s(function(e){var n=!1,i=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,function(r){n||(n=!0,t!==r?C(e,r):B(e,r))},function(t){n||(n=!0,L(e,t))},e._label);!n&&i&&(n=!0,L(e,i))},e)}(t,r,n):B(t,r)}function C(e,t){var r,n;e===t?L(e,new TypeError("You cannot resolve a promise with itself")):(n=typeof(r=t),null===r||"object"!==n&&"function"!==n?B(e,t):S(e,t,P(t)))}function D(e){e._onerror&&e._onerror(e._result),j(e)}function B(e,t){e._state===R&&(e._result=t,e._state=x,0!==e._subscribers.length&&s(j,e))}function L(e,t){e._state===R&&(e._state=O,e._result=t,s(D,e))}function I(e,t,r,n){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+x]=r,i[o+O]=n,0===o&&e._state&&s(j,e)}function j(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,i=void 0,o=e._result,a=0;a<t.length;a+=3)n=t[a],i=t[a+r],n?F(r,n,i,o):i(o);e._subscribers.length=0}}function F(t,r,n,i){var o=e(n),a=void 0,s=void 0,u=void 0,f=void 0;if(o){if((a=function(e,t){try{return e(t)}catch(e){return k.error=e,k}}(n,i))===k?(f=!0,s=a.error,a.error=null):u=!0,r===a)return void L(r,new TypeError("A promises callback cannot return that same promise."))}else a=i,u=!0;r._state!==R||(o&&u?C(r,a):f?L(r,s):t===x?B(r,a):t===O&&L(r,a))}var G=0;function N(e){e[E]=G++,e._state=void 0,e._result=void 0,e._subscribers=[]}var U=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(A),this.promise[E]||N(this.promise),n(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?B(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&B(this.promise,this._result))):L(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===R&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===T){var i=P(e);if(i===_&&e._state!==R)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(r===V){var o=new r(A);S(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new r(function(t){return t(e)}),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===R&&(this._remaining--,e===O?L(n,r):this._result[t]=r),0===this._remaining&&B(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;I(e,void 0,function(e){return r._settledAt(x,t,e)},function(e){return r._settledAt(O,t,e)})},e}();var V=function(){function e(t){this[E]=G++,this._result=this._state=void 0,this._subscribers=[],A!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t(function(t){C(e,t)},function(t){L(e,t)})}catch(t){L(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var t=this.constructor;return this.then(function(r){return t.resolve(e()).then(function(){return r})},function(r){return t.resolve(e()).then(function(){throw r})})},e}();return V.prototype.then=_,V.all=function(e){return new U(this,e).promise},V.race=function(e){var t=this;return n(e)?new t(function(r,n){for(var i=e.length,o=0;o<i;o++)t.resolve(e[o]).then(r,n)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},V.resolve=T,V.reject=function(e){var t=new this(A);return L(t,e),t},V._setScheduler=function(e){a=e},V._setAsap=function(e){s=e},V._asap=s,V.polyfill=function(){var e=void 0;if(void 0!==r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=V},V.Promise=V,V},e.exports=n()}).call(this,r(31),r(30))},function(e,t,r){r(32).polyfill();var n=r(29),i=r(23),o=r(15),a=(r(14),r(1)),s=r(13),u=r(7),f=r(8),c=r(6),d=r(2),l=r(12);r(11),r(9);function h(e){e=e||{};var t="ogvjs"+ ++h.instanceCount,r=null,m={};void 0!==e.webGL&&(m.webGL=e.webGL),e.forceWebGL&&(m.webGL="required");var v=!!window.Worker;void 0!==e.worker&&(v=!!e.worker);var y=a.wasmSupported();void 0!==e.wasm&&(y=!!e.wasm);var b=!!e.threading;y&&(b=!1),void 0===e.sync&&(e.sync="skip-frames");var g={INITIAL:"INITIAL",SEEKING_END:"SEEKING_END",LOADED:"LOADED",PRELOAD:"PRELOAD",READY:"READY",PLAYING:"PLAYING",SEEKING:"SEEKING",ENDED:"ENDED",ERROR:"ERROR"},w=g.INITIAL,_={NOT_SEEKING:"NOT_SEEKING",BISECT_TO_TARGET:"BISECT_TO_TARGET",BISECT_TO_KEYPOINT:"BISECT_TO_KEYPOINT",LINEAR_TO_TARGET:"LINEAR_TO_TARGET"},T=_.NOT_SEEKING,E={},A={};e.base=e.base||a.base,"string"==typeof e.base&&(E.base=e.base,A.base=e.base),void 0!==e.audioContext&&(E.audioContext=e.audioContext),void 0!==e.audioDestination&&(E.output=e.audioDestination),E.bufferSize=8192,A.worker=v,A.threading=b,A.wasm=y,"number"!=typeof e.memoryLimit||y||(A.memoryLimit=e.memoryLimit);var R,x,O=document.createElement("canvas"),k=document.createElement("ogvjs");function P(e){var t=x();e();var r=x()-t;return Pe+=r,r}k.className=t,u(k,p),O.style.position="absolute",O.style.top="0",O.style.left="0",O.style.width="100%",O.style.height="100%",O.style.objectFit="contain",k.appendChild(O);var S=(x=void 0===window.performance||void 0===window.performance.now?Date.now:window.performance.now.bind(window.performance))();function C(t){if(e.debug){var r=x()-S;e.debugFilter&&!t.match(e.debugFilter)||console.log("["+Math.round(10*r)/10+"ms] "+t)}}function D(e,t){var r;C("fireEvent "+e),t=t||{};var n="function"==typeof window.Event;for(var i in n?r=new CustomEvent(e):(r=document.createEvent("Event")).initEvent(e,!1,!1),t)t.hasOwnProperty(i)&&(r[i]=t[i]);var o=k.dispatchEvent(r);!n&&"resize"===e&&k.onresize&&o&&k.onresize.call(k,r)}function B(e,t){C("fireEventAsync "+e),setTimeout(function(){D(e,t)},0)}var L=null,I=null,j=null,F=[],G=null,N=!1,U=0,V=0,M=!1,X=0;function W(){(G=new o(E)).init(j.channels,j.rate),G.bufferThreshold=1,G.volume=k.volume,G.muted=k.muted,G.onbufferlow=function(){C("onbufferlow"),K&&(K.buffering||K.seeking)||ft||vt()},G.onstarved=function(){ee?C("onstarved: appear to have reached end of audio"):(C("onstarved: halting audio due to starvation"),z(),M=!0),ht()||vt(0)}}function H(e){if(G){G.start();var t=G.getPlaybackState();U=t.playbackPosition}else U=x()/1e3;void 0!==e&&(V=e),M=!1,C("continuing at "+U+", "+V)}function z(){C("pausing at "+(V=Y())),G&&G.stop()}function Y(e){return M||se?V:(G?(e=e||G.getPlaybackState()).playbackPosition:x()/1e3)-U+V}var K,Q,q,J="",$=!1,Z=null,ee=!1,te=0,re=null,ne=null,ie=null,oe=!1,ae=!1,se=!0,ue=!1,fe=!1,ce=0,de=1e3/60,le=0,he=0,pe=0,me=0,ve=0,ye=0,be=0,ge=0,we=0,_e=0,Te=0,Ee="";function Ae(){C("STOPPING"),w=g.INITIAL,T=_.NOT_SEEKING,ae=!1,ue=!1,Re=0,xe=0,Pe=0,M=!1,F.splice(0,F.length),K&&(K.abort(),K=null,$=!1),L&&(L.close(),L=null,ut=0,ft=0,ee=!1),I=null,j=null,G&&(G.close(),G=null),Q&&(clearTimeout(Q),Q=null),ie&&(clearTimeout(ie),ie=null),R&&(R.clear(),R=null),Oe&&(Oe=[]),ke&&(ke=[]),X=0,U=0,V=0,re=null}x();var Re=0,xe=0,Oe=[],ke=[],Pe=0,Se=0,Ce=0,De=0,Be=0,Le=0,Ie=0,je=0,Fe=0,Ge=0,Ne=0,Ue=0,Ve=0,Me=0,Xe=0,We=0,He=250;function ze(e){e=e||{},fe&&!document.body.contains(k)&&setTimeout(function(){k.stop()},0);var t=x(),r=t-Me,n=le-de;ge+=Math.abs(n),me+=r;var i={cpuTime:Pe,drawingTime:ye-Be,bufferTime:ve-Le,proxyTime:be-Ie,demuxerTime:0,videoTime:0,audioTime:0,clockTime:le,late:e.dropped,dropped:e.dropped};function o(e){return Math.round(10*e)/10}L&&(i.demuxerTime=L.demuxerCpuTime-De,i.videoTime+=Xe-Se,i.audioTime+=L.audioCpuTime-Ce),i.cpuTime+=i.demuxerTime,Pe=0,Me=t,L?(Se=Xe,Ce=L.audioCpuTime,De=L.demuxerCpuTime):(Se=0,Ce=0,De=0),Be=ye,Le=ve,Ie=be,C("drew frame "+e.frameEndTimestamp+": clock time "+o(r)+" (jitter "+o(n)+") cpu: "+o(i.cpuTime)+" (mux: "+o(i.demuxerTime)+" buf: "+o(i.bufferTime)+" draw: "+o(i.drawingTime)+" proxy: "+o(i.proxyTime)+") vid: "+o(i.videoTime)+" aud: "+o(i.audioTime)),B("framecallback",i),(!We||t-We>=He)&&(We=t,B("timeupdate"))}var Ye,Ke,Qe,qe,Je=0,$e=0,Ze={EXACT:"exact",FAST:"fast"};function et(e){K.seeking&&K.abort(),K.buffering&&K.abort(),$=!1,ee=!1,ue=!1,K.seek(e).then(function(){pt()}).catch(mt)}function tt(e){var t=Math.max(0,K.length-65536);$e=e,(Qe=new s({start:0,end:t,process:function(e,t,r){return r!=Ke&&(Ke=r,!1,L.flush(function(){et(r)}),!0)}})).start()}function rt(e,t){if(C("requested seek to "+e+", mode "+t),k.readyState==k.HAVE_NOTHING)return C("not yet loaded; saving seek position for later"),void(X=e);if(K&&!K.seekable)throw new Error("Cannot seek a non-seekable stream");if(L&&!L.seekable)throw new Error("Cannot seek in a non-seekable file");function r(r){K&&K.buffering&&K.abort(),K&&K.seeking&&K.abort(),F.splice(0,F.length),z(),M=!1,G&&G.flush(),w=g.SEEKING,Je=e,Ye=t,L?L.flush(r):r()}r(function(){ht()||vt(0)}),F.push(function(){r(function(){nt(e)})})}function nt(e){$=!1,ee=!1,ue=!1,w=g.SEEKING,Je=e,-1,!1,Ke=-1,Oe=[],ke=[],ut=0,ft=0,qe=!1,L.seekToKeypoint(e,function(t){if(t)return T=_.LINEAR_TO_TARGET,B("seeking"),qe?void 0:void vt();L.getKeypointOffset(e,function(e){e>0?(T=_.LINEAR_TO_TARGET,et(e)):(T=_.BISECT_TO_TARGET,tt(Je)),B("seeking")})})}function it(){function e(){We=Je,B("timeupdate"),B("seeked"),ht()||vt()}T=_.NOT_SEEKING,w=g.READY,Re=L.frameTimestamp,xe=L.audioTimestamp,Je=L.hasAudio?L.audioTimestamp:L.frameTimestamp,V=Je,L.hasVideo&&L.frameReady?L.decodeFrame(function(t){t&&(q&&(k.removeChild(q),q=null),R.drawFrame(L.frameBuffer)),e()}):e()}function ot(){var e,t;if(L.hasVideo)t=L.frameTimestamp,e=de/1e3;else{if(!L.hasAudio)throw new Error("Invalid seek state; no audio or video track available");t=L.audioTimestamp,e=1/256}t<0?L.process(function(e){if(e)vt();else if($){if(C("stream ended during bisection seek"),!Qe.right())throw C("failed going back"),new Error("not sure what to do")}else pt()}):t-e/2>$e?Qe.left()||(C("close enough (left)"),Je=t,it()):t+e/2<$e?Qe.right()||(C("close enough (right)"),T=_.LINEAR_TO_TARGET,vt()):T==_.BISECT_TO_TARGET&&L.hasVideo&&L.keyframeTimestamp<L.frameTimestamp?(C("finding the keypoint now"),T=_.BISECT_TO_KEYPOINT,tt(L.keyframeTimestamp)):(C("straight seeking now"),T=_.LINEAR_TO_TARGET,vt())}var at=0,st=!1,ut=0,ft=0,ct=3,dt=4;function lt(){if(F.length)F.shift()();else if(w==g.INITIAL)if(L.loadedMetadata){if(!L.hasVideo&&!L.hasAudio)throw new Error("No audio or video found, something is wrong");L.hasAudio&&(j=L.audioFormat),L.hasVideo&&(I=L.videoFormat,de=I.fps>0?1e3/I.fps:16.667,O.width=I.displayWidth,O.height=I.displayHeight,h.styleManager.appendRule("."+t,{width:I.displayWidth+"px",height:I.displayHeight+"px"}),h.updatePositionOnResize(),R=n.attach(O,m)),isNaN(L.duration)||(re=L.duration),null===re&&K.seekable?(w=g.SEEKING_END,ne=-1,L.flush(function(){et(Math.max(0,K.length-131072))})):(w=g.LOADED,vt())}else L.process(function(e){if(e)vt();else{if($)throw new Error("end of file before headers found");C("reading more cause we are out of data"),pt()}});else if(w==g.SEEKING_END)L.frameReady?(C("saw frame with "+L.frameTimestamp),ne=Math.max(ne,L.frameTimestamp),L.discardFrame(function(){vt()})):L.audioReady?(C("saw audio with "+L.audioTimestamp),ne=Math.max(ne,L.audioTimestamp),L.discardAudio(function(){vt()})):L.process(function(e){e?vt():K.eof?(C("seek-duration: we are at the end: "+ne),ne>0&&(re=ne),w=g.LOADED,L.flush(function(){$=!1,ee=!1,et(0)})):pt()});else if(w==g.LOADED)w=g.PRELOAD,B("loadedmetadata"),B("durationchange"),L.hasVideo&&B("resize"),vt(0);else if(w==g.PRELOAD)!L.frameReady&&L.hasVideo||!L.audioReady&&L.hasAudio?L.process(function(e){e?vt():$?ue=!0:pt()}):(w=g.READY,B("loadeddata"),vt());else if(w==g.READY)if(C("initial seek to "+X),X>0){var e=X;X=0,C("initial seek to "+e),nt(e)}else if(se)C("paused while in ready");else{function r(){C("finishStartPlaying"),w=g.PLAYING,Me=x(),L.hasAudio&&G?M=!0:H(),vt(0),B("play"),B("playing")}!L.hasAudio||G||N?r():(W(),G.waitUntilReady(r))}else if(w==g.SEEKING){if(T==_.NOT_SEEKING)throw new Error("seeking in invalid state (not seeking?)");if(T==_.BISECT_TO_TARGET)ot();else if(T==_.BISECT_TO_KEYPOINT)ot();else{if(T!=_.LINEAR_TO_TARGET)throw new Error("Invalid seek state "+T);!function(){var e;if(e=L.hasVideo?de/1e3:1/256,L.hasVideo){if(ut)return;if(!L.frameReady)return void L.process(function(e){e?vt():$?(C("stream ended during linear seeking on video"),ee=!0,it()):pt()});if(Ye===Ze.FAST&&L.keyframeTimestamp==L.frameTimestamp)return void it();if(L.frameTimestamp+e<Je)return void L.decodeFrame(function(){vt()});if(!L.hasAudio)return void it()}if(L.hasAudio){if(ft)return;L.audioReady?L.audioTimestamp+e<Je?L.decodeAudio(function(){vt()}):it():L.process(function(e){e?vt():$?(C("stream ended during linear seeking on audio"),ee=!0,it()):pt()})}}()}}else if(w==g.PLAYING){function i(){var e=L.frameReady,t=L.audioReady;L.process(function(r){L.frameReady&&!e||L.audioReady&&!t?(C("demuxer has packets"),vt()):r?(C("demuxer processing to find more packets"),vt()):(C("demuxer ran out of data"),$?(C("demuxer reached end of data stream"),ee=!0,vt()):(C("demuxer loading more data"),pt()))})}!function(){if(se)C("paused during playback; stopping loop");else if((!L.hasAudio||L.audioReady||ft||ee)&&(!L.hasVideo||L.frameReady||ut||Oe.length||ee)){var e,t,r,n=null,o=0,a=!1,s=0;if(L.hasAudio&&G?(o=Y(n=G.getPlaybackState()),a=ee&&0==G.durationBuffered,M&&(G.durationBuffered>=2*G.bufferThreshold||ee)&&(C("prebuffering audio done; buffered to "+G.durationBuffered),H(o),M=!1),n.dropped!=we&&C("dropped "+(n.dropped-we)),n.delayed!=_e&&C("delayed "+(n.delayed-_e)),we=n.dropped,_e=n.delayed,(e=G.durationBuffered<=2*G.bufferThreshold)&&(L.audioReady?ft>=dt&&(C("audio decode disabled: "+ft+" packets in flight"),e=!1):e=!1)):(o=Y(),e=L.audioReady&&xe<o),L.hasVideo){t=Oe.length>0,r=ut+Oe.length<ct&&L.frameReady,t&&(s=1e3*(Oe[0].frameEndTimestamp-o),le=de-s);var u=de;if(M)r&&C("decoding a frame during prebuffering"),t=!1;else if(t&&ee&&a)C("audio timeline ended? ready to draw frame");else if(t&&-s>=u){for(var f=-1,c=0;c<Oe.length-1;c++)Oe[c].frameEndTimestamp<o&&(f=c-1);if(f>=0)for(;f-- >=0;)Te++,C("skipping already-decoded late frame at "+(h=Oe.shift()).frameEndTimestamp),s=1e3*(h.frameEndTimestamp-o),Re=h.frameEndTimestamp,le=de-s,ce++,h.dropped=!0,ze();var d=L.nextKeyframeTimestamp,l=d-de/1e3*(ct+ut);if(d>=0&&d!=L.frameTimestamp&&o>=l){for(C("skipping late frame at "+Oe[0].frameEndTimestamp+" vs "+o+", expect to see keyframe at "+d),c=0;c<Oe.length;c++){var h=Oe[c];Te++,ce++,Re=h.frameEndTimestamp,s=1e3*(h.frameEndTimestamp-o),le=de-s,h.dropped=!0,ze(h)}for(Oe=[],c=0;c<ke.length;c++)h=ke[c],Te++,ce++,Re=h.frameEndTimestamp,s=1e3*(h.frameEndTimestamp-o),le=de-s,h.dropped=!0,ze(h);for(ke=[],ut=0;L.frameReady&&L.frameTimestamp<d;)s=1e3*((h={frameEndTimestamp:L.frameTimestamp,dropped:!0}).frameEndTimestamp-o),le=de-s,Te++,L.discardFrame(function(){}),ce++,ze(h);return void(ht()||vt())}}else t&&s<=4||(t=!1)}if(r){C("play loop: ready to decode frame; thread depth: "+ut+", have buffered: "+Oe.length),0==I.fps&&L.frameTimestamp-Re>0&&(de=1e3*(L.frameTimestamp-Re)),he+=de,pe++;var p=Re=L.frameTimestamp;ut++,ke.push({frameEndTimestamp:p});var m=ke,v=!1,y=P(function(){L.decodeFrame(function(e){m===ke?(C("play loop callback: decoded frame"),ut--,ke.shift(),e?Oe.push({yCbCrBuffer:L.frameBuffer,videoCpuTime:L.videoCpuTime,frameEndTimestamp:p}):C("Bad video packet or something"),L.process(function(){ht()||vt(v?void 0:0)})):C("play loop callback after flush, discarding")})});ut&&(v=!0,be+=y,vt())}else if(e){C("play loop: ready for audio; depth: "+ft),ft++;var b=L.audioTimestamp,g=P(function(){L.decodeAudio(function(e){if(ft--,C("play loop callback: decoded audio"),xe=b,e){var t=L.audioBuffer;t&&(ve+=P(function(){G&&G.bufferData(t)}),L.hasVideo||(ce++,ze({frameEndTimestamp:xe})))}ht()||vt()})});ft&&(be+=g,L.audioReady?vt():i())}else if(t)C("play loop: ready to draw frame"),ie&&(clearTimeout(ie),ie=null),q&&(k.removeChild(q),q=null),h=Oe.shift(),Xe=h.videoCpuTime,ye+=P(function(){R.drawFrame(h.yCbCrBuffer)}),ce++,0,ze(h),vt();else if(!Oe.length||ie||M)if(ee&&!(ft||ut||Oe.length)){C("play loop: playback reached end of data "+[ft,ut,Oe.length]);var w=0;L.hasAudio&&G&&(w=1e3*G.durationBuffered),w>0?(C("play loop: ending pending "+w+" ms"),vt(Math.max(0,w))):(C("play loop: ENDING NOW: playback time "+Y()+"; frameEndTimestamp: "+Re),z(),M=!1,V=Math.max(xe,Re),ue=!0,se=!0,B("pause"),B("ended"))}else C("play loop: waiting on async/timers");else{var _=s;C("play loop: setting a timer for drawing "+_),ie=setTimeout(function(){ie=null,vt()},_)}}else C("play loop: demuxing"),i()}()}else if(w!=g.ERROR)throw new Error("Unexpected OGVPlayer state "+w)}function ht(){return K&&(K.buffering||K.seeking)||L&&L.processing}function pt(){if(K.buffering||K.seeking)C("readBytesAndWait during i/o");else{K.read(32768).then(function(e){C("got input "+[e.byteLength]),e.byteLength&&F.push(function(){L.receiveInput(e,function(){vt()})}),K.eof&&(C("stream is at end!"),$=!0),ht()||vt()}).catch(mt)}}function mt(e){"AbortError"===e.name?C("i/o promise canceled; ignoring"):(C("i/o error: "+e),Z=new f(f.MEDIA_ERR_NETWORK,""+e),w=g.ERROR,z())}function vt(e){if(void 0===e&&(e=-1),K&&K.waiting)C("waiting on input");else{Q&&(C("canceling old processing timer"),clearTimeout(Q),Q=null);e>-1/256?Q=setTimeout(function(){vt()},e):at?st=!0:function(){if(qe&&(qe=!1),Q=null,ht(),at>0)throw new Error("REENTRANCY FAIL: doProcessing recursing unexpectedly");var e=0;do{if(st=!1,at++,lt(),at--,st&&ht())throw new Error("REENTRANCY FAIL: waiting on input or codec but asked to keep processing");++e>500&&(C("stuck in processing loop; breaking with timer"),st=0,vt(0))}while(st)}()}}function yt(e){ae||L||(ce=0,ve=0,ye=0,be=0,ae=!0,ue=!1,L=new r(A),je=0,Fe=0,Ge=0,Ne=0,Ve=0,Ue=0,Se=0,Ce=0,De=0,Le=0,Ie=0,Be=0,Xe=0,L.onseek=function(e){qe=!0,K&&et(e)},L.init(function(){L.receiveInput(e,pt)}))}function bt(e){function t(){(K=new i({url:k.src,cacheSize:16777216})).load().then(function(){oe=!1,J=k.src,te=K.seekable?K.length:0;var e,t=K.headers["x-content-duration"];"string"==typeof t&&(re=parseFloat(t)),e=yt,K.read(1024).then(function(t){var n=new Uint8Array(t);n.length>4&&n[0]=="O".charAt(0)&&n[1]=="g".charAt(0)&&n[2]=="g".charAt(0)&&n[3]=="S".charAt(0)?A.type="video/ogg":n.length>4&&26==n[0]&&69==n[1]&&223==n[2]&&163==n[3]?A.type="video/webm":A.type="video/ogg",r=l,e(t)})}).catch(mt)}Ae(),J="",oe=!0,F.push(function(){e&&"none"===k.preload?oe=!1:t()}),vt(0)}k.load=function(){bt()},k.canPlayType=function(e){var t=new c(e);function r(e){if(t.codecs){var r=0,n=0;return t.codecs.forEach(function(t){e.indexOf(t)>=0?r++:n++}),0===r?"":n>0?"":"probably"}return"maybe"}return"ogg"!==t.minor||"audio"!==t.major&&"video"!==t.major&&"application"!==t.major?"webm"!==t.minor||"audio"!==t.major&&"video"!==t.major?"":r(["vorbis","opus","vp8","vp9"]):r(["vorbis","opus","theora"])},k.play=function(){N||E.audioContext||h.initSharedAudioContext(),se&&(fe=document.body.contains(k),se=!1,w==g.SEEKING||(ae&&L&&L.loadedMetadata?(ue&&K&&te?(C(".play() starting over after end"),rt(0)):C(".play() while already started"),w=g.READY,ht()||vt()):oe?C(".play() while loading"):(C(".play() before started"),K||k.load())))},k.getPlaybackStats=function(){return{targetPerFrameTime:de,framesProcessed:ce,videoBytes:L?L.videoBytes:0,audioBytes:L?L.audioBytes:0,playTime:me,demuxingTime:L?L.demuxerCpuTime-Ge:0,videoDecodingTime:L?L.videoCpuTime-je:0,audioDecodingTime:L?L.audioCpuTime-Fe:0,bufferTime:ve-Ne,drawingTime:ye-Ve,proxyTime:be-Ue,droppedAudio:we,delayedAudio:_e,jitter:ge/ce,lateFrames:Te}},k.resetPlaybackStats=function(){ce=0,bytesProcessed=0,me=0,L&&(Ge=L.demuxerCpuTime,je=L.videoCpuTime,Fe=L.audioCpuTime,L.videoBytes=0,L.audioBytes=0),Ne=ve,Ve=ye,Ue=be,ge=0,he=0,pe=0},k.getVideoFrameSink=function(){return R},k.getCanvas=function(){return O},k.pause=function(){se||(clearTimeout(Q),Q=null,z(),M=!1,se=!0,D("pause"))},k.stop=function(){Ae(),se=!0},k.fastSeek=function(e){rt(+e,Ze.FAST)};var gt=0,wt=0,_t=1;return Object.defineProperties(k,{src:{get:function(){return k.getAttribute("src")||""},set:function(e){k.setAttribute("src",e),oe=!1,bt("interactive")}},buffered:{get:function(){var e;return e=K&&te&&re?K.getBufferedRanges().map(function(e){return e.map(function(e){return e/K.length*re})}):[[0,0]],new d(e)}},seekable:{get:function(){return k.duration<1/0&&K&&K.seekable&&L&&L.seekable?new d([[0,re]]):new d([])}},currentTime:{get:function(){return w==g.SEEKING?Je:L?w!=g.PLAYING||se?V:Y():X},set:function(e){rt(e,Ze.EXACT)}},duration:{get:function(){return L&&L.loadedMetadata?null!==re?re:1/0:NaN}},paused:{get:function(){return se}},ended:{get:function(){return ue}},seeking:{get:function(){return w==g.SEEKING}},muted:{get:function(){return N},set:function(e){N=e,G?G.muted=N:ae&&!N&&L&&L.hasAudio&&(C("unmuting: switching from timer to audio clock"),W(),H(xe)),B("volumechange")}},poster:{get:function(){return Ee},set:function(e){Ee=e,ae||(q&&k.removeChild(q),(q=new Image).src=Ee,q.className="ogvjs-poster",q.style.position="absolute",q.style.top="0",q.style.left="0",q.style.width="100%",q.style.height="100%",q.style.objectFit="contain",q.style.visibility="hidden",q.addEventListener("load",function(){q===this&&(h.styleManager.appendRule("."+t,{width:q.naturalWidth+"px",height:q.naturalHeight+"px"}),h.updatePositionOnResize(),q.style.visibility="visible")}),k.appendChild(q))}},videoWidth:{get:function(){return I?I.displayWidth:0}},videoHeight:{get:function(){return I?I.displayHeight:0}},ogvjsVideoFrameRate:{get:function(){return I?0==I.fps?pe/(he/1e3):I.fps:0}},ogvjsAudioChannels:{get:function(){return j?j.channels:0}},ogvjsAudioSampleRate:{get:function(){return j?j.rate:0}},width:{get:function(){return gt},set:function(e){gt=parseInt(e,10),k.style.width=gt+"px",h.updatePositionOnResize()}},height:{get:function(){return wt},set:function(e){wt=parseInt(e,10),k.style.height=wt+"px",h.updatePositionOnResize()}},autoplay:{get:function(){return!1},set:function(e){}},controls:{get:function(){return!1},set:function(e){}},loop:{get:function(){return!1},set:function(e){}},crossOrigin:{get:function(){return null},set:function(e){}},currentSrc:{get:function(){return J}},defaultMuted:{get:function(){return!1}},defaultPlaybackRate:{get:function(){return 1}},error:{get:function(){return w===g.ERROR?Z||new f("unknown error occurred in media procesing"):null}},preload:{get:function(){return k.getAttribute("preload")||""},set:function(e){k.setAttribute("preload",e)}},readyState:{get:function(){return K&&L&&L.loadedMetadata?h.HAVE_ENOUGH_DATA:h.HAVE_NOTHING}},networkState:{get:function(){return K?K.waiting?h.NETWORK_LOADING:h.NETWORK_IDLE:k.readyState==h.HAVE_NOTHING?h.NETWORK_EMPTY:h.NETWORK_NO_SOURCE}},playbackRate:{get:function(){return 1},set:function(e){}},played:{get:function(){return new d([[0,k.currentTime]])}},volume:{get:function(){return _t},set:function(e){_t=+e,G&&(G.volume=_t),B("volumechange")}}}),k.onframecallback=null,k.onloadstate=null,k.onprogress=null,k.onsuspend=null,k.onabort=null,k.onemptied=null,k.onstalled=null,k.onloadedmetadata=null,k.onloadeddata=null,k.oncanplay=null,k.oncanplaythrough=null,k.onplaying=null,k.onwaiting=null,k.onseeking=null,k.onseeked=null,k.onended=null,k.ondurationchange=null,k.ontimeupdate=null,k.onplay=null,k.onpause=null,k.onratechange=null,k.onresize=null,k.onvolumechange=null,k}h.initSharedAudioContext=function(){o.initSharedAudioContext()};var p={NETWORK_EMPTY:0,NETWORK_IDLE:1,NETWORK_LOADING:2,NETWORK_NO_SOURCE:3,HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4};if(u(h,p),h.instanceCount=0,h.styleManager=new function(){var e=document.createElement("style");e.type="text/css",e.textContent="ogvjs { display: inline-block; position: relative; -webkit-user-select: none; -webkit-tap-highlight-color: rgba(0,0,0,0); ",document.head.appendChild(e);var t=e.sheet;this.appendRule=function(e,r){var n=[];for(var i in r)r.hasOwnProperty(i)&&n.push(i+":"+r[i]);var o=e+"{"+n.join(";")+"}";t.insertRule(o,t.cssRules.length-1)}},h.supportsObjectFit="string"==typeof document.createElement("canvas").style.objectFit,h.supportsObjectFit&&navigator.userAgent.match(/iPhone|iPad|iPod Touch/)&&(h.supportsObjectFit=!1),h.supportsObjectFit&&navigator.userAgent.match(/Edge/)&&(h.supportsObjectFit=!1),h.supportsObjectFit)h.updatePositionOnResize=function(){};else{h.updatePositionOnResize=function(){function e(e,t,r){var n=e.offsetParent||e.parentNode,i=t/r;if(i>n.offsetWidth/n.offsetHeight){var o=n.offsetWidth/i,a=(n.offsetHeight-o)/2;e.style.width="100%",e.style.height=o+"px",e.style.marginLeft=0,e.style.marginRight=0,e.style.marginTop=a+"px",e.style.marginBottom=a+"px"}else{var s=n.offsetHeight*i,u=(n.offsetWidth-s)/2;e.style.width=s+"px",e.style.height="100%",e.style.marginLeft=u+"px",e.style.marginRight=u+"px",e.style.marginTop=0,e.style.marginBottom=0}}function t(e,t){var r=document.querySelectorAll(e);Array.prototype.slice.call(r).forEach(t)}t("ogvjs > canvas",function(t){e(t,t.width,t.height)}),t("ogvjs > img",function(t){e(t,t.naturalWidth,t.naturalHeight)})};var m=function(){setTimeout(h.updatePositionOnResize,0)};window.addEventListener("resize",h.updatePositionOnResize),window.addEventListener("orientationchange",h.updatePositionOnResize),document.addEventListener("fullscreenchange",m),document.addEventListener("mozfullscreenchange",m),document.addEventListener("webkitfullscreenchange",m),document.addEventListener("MSFullscreenChange",m)}e.exports=h},function(e,t){var r,n=!1,i={wasmSupported:function(){if(!n){try{"object"==typeof WebAssembly?(e=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),t=new WebAssembly.Module(e),r=0!==new WebAssembly.Instance(t,{}).exports.test(4)):r=!1}catch(e){console.log("Exception while testing WebAssembly",e),r=!1}n=!0}var e,t;return r}};e.exports=i},function(e,t){e.exports=function(){var e,t=this;e=window.performance&&window.performance.now?function(){return window.performance.now()}:function(){return Date.now()};var r=null;Object.defineProperty(t,"speed",{get:function(){return null===r&&function(){var t=0,n=function(e){return t++,e<2?e:n(e-2)+n(e-1)},i=e();n(30);var o=e()-i;r=t/o}(),r}}),Object.defineProperty(t,"slowCutoff",{get:function(){return 5e4}}),Object.defineProperty(t,"tooSlowCutoff",{get:function(){return 0}}),Object.defineProperty(t,"slow",{get:function(){return t.speed<t.slowCutoff}}),Object.defineProperty(t,"tooSlow",{get:function(){return t.speed<t.tooSlowCutoff}})}},function(e,t,r){var n={benchmark:new(r(35)),hasTypedArrays:function(){return!!window.Uint32Array},hasWebAudio:function(){return!(!window.AudioContext&&!window.webkitAudioContext)},hasFlash:function(){if(-1!==navigator.userAgent.indexOf("Trident"))try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash");return!0}catch(e){return!1}return!1},hasAudio:function(){return this.hasWebAudio()||this.hasFlash()},isBlacklisted:function(e){var t=!1;return[/\(i.* OS [67]_.* like Mac OS X\).* Mobile\/.* Safari\//,/\(Macintosh.* Version\/6\..* Safari\/\d/].forEach(function(r){e.match(r)&&(t=!0)}),t},isSlow:function(){return this.benchmark.slow},isTooSlow:function(){return this.benchmark.tooSlow},supported:function(e){return"OGVDecoder"===e?this.hasTypedArrays()&&!this.isBlacklisted(navigator.userAgent):"OGVPlayer"===e&&(this.supported("OGVDecoder")&&this.hasAudio()&&!this.isTooSlow())}};e.exports=n},function(e,t,r){var n=r(36),i=r(1),o=r(8),a=r(6),s=r(33),u=r(2);window&&(window.OGVCompat=n,window.OGVLoader=i,window.OGVMediaError=o,window.OGVMediaType=a,window.OGVTimeRanges=u,window.OGVPlayer=s,window.OGVVersion="1.5.8-20180809032045-40c82e69"),e.exports={OGVCompat:n,OGVLoader:i,OGVMediaType:a,OGVPlayer:s,OGVVersion:"1.5.8-20180809032045-40c82e69"}}])});